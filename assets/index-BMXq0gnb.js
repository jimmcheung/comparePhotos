import{r as p,a as Qr,g as kr,R as ne,b as bt}from"./vendor-Dja1Ap5q.js";import{h as ei,v as Sr}from"./heic-kq-hUwqs.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var Cr={exports:{}},Bt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ti=p,ni=Symbol.for("react.element"),ri=Symbol.for("react.fragment"),ii=Object.prototype.hasOwnProperty,si=ti.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,oi={key:!0,ref:!0,__self:!0,__source:!0};function jr(n,e,t){var r,i={},o=null,a=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)ii.call(e,r)&&!oi.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:ni,type:n,key:o,ref:a,props:i,_owner:si.current}}Bt.Fragment=ri;Bt.jsx=jr;Bt.jsxs=jr;Cr.exports=Bt;var s=Cr.exports,on={},Gn=Qr;on.createRoot=Gn.createRoot,on.hydrateRoot=Gn.hydrateRoot;const ai={},Xn=n=>{let e;const t=new Set,r=(h,x)=>{const v=typeof h=="function"?h(e):h;if(!Object.is(v,e)){const F=e;e=x??(typeof v!="object"||v===null)?v:Object.assign({},e,v),t.forEach(k=>k(e,F))}},i=()=>e,d={setState:r,getState:i,getInitialState:()=>g,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(ai?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},g=e=n(r,i,d);return d},li=n=>n?Xn(n):Xn;var Ir={exports:{}},Pr={},Er={exports:{}},Nr={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ut=p;function ci(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var di=typeof Object.is=="function"?Object.is:ci,ui=ut.useState,hi=ut.useEffect,fi=ut.useLayoutEffect,gi=ut.useDebugValue;function pi(n,e){var t=e(),r=ui({inst:{value:t,getSnapshot:e}}),i=r[0].inst,o=r[1];return fi(function(){i.value=t,i.getSnapshot=e,Zt(i)&&o({inst:i})},[n,t,e]),hi(function(){return Zt(i)&&o({inst:i}),n(function(){Zt(i)&&o({inst:i})})},[n]),gi(t),t}function Zt(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!di(n,t)}catch{return!0}}function mi(n,e){return e()}var xi=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?mi:pi;Nr.useSyncExternalStore=ut.useSyncExternalStore!==void 0?ut.useSyncExternalStore:xi;Er.exports=Nr;var yi=Er.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $t=p,bi=yi;function vi(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var wi=typeof Object.is=="function"?Object.is:vi,ki=bi.useSyncExternalStore,Si=$t.useRef,Ci=$t.useEffect,ji=$t.useMemo,Ii=$t.useDebugValue;Pr.useSyncExternalStoreWithSelector=function(n,e,t,r,i){var o=Si(null);if(o.current===null){var a={hasValue:!1,value:null};o.current=a}else a=o.current;o=ji(function(){function d(F){if(!g){if(g=!0,h=F,F=r(F),i!==void 0&&a.hasValue){var k=a.value;if(i(k,F))return x=k}return x=F}if(k=x,wi(h,F))return k;var E=r(F);return i!==void 0&&i(k,E)?(h=F,k):(h=F,x=E)}var g=!1,h,x,v=t===void 0?null:t;return[function(){return d(e())},v===null?void 0:function(){return d(v())}]},[e,t,r,i]);var l=ki(n,o[0],o[1]);return Ci(function(){a.hasValue=!0,a.value=l},[l]),Ii(l),l};Ir.exports=Pr;var Pi=Ir.exports;const Ei=kr(Pi),Mr={},{useDebugValue:Ni}=ne,{useSyncExternalStoreWithSelector:Mi}=Ei;let Yn=!1;const Ai=n=>n;function Ti(n,e=Ai,t){(Mr?"production":void 0)!=="production"&&t&&!Yn&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Yn=!0);const r=Mi(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return Ni(r),r}const Kn=n=>{(Mr?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?li(n):n,t=(r,i)=>Ti(e,r,i);return Object.assign(t,e),t},zt=n=>n?Kn(n):Kn,Fi={};function Di(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var o;const a=d=>d===null?null:JSON.parse(d,void 0),l=(o=t.getItem(i))!=null?o:null;return l instanceof Promise?l.then(a):a(l)},setItem:(i,o)=>t.setItem(i,JSON.stringify(o,void 0)),removeItem:i=>t.removeItem(i)}}const kt=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return kt(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return kt(r)(t)}}}},Li=(n,e)=>(t,r,i)=>{let o={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:P=>P,version:0,merge:(P,S)=>({...S,...P}),...e},a=!1;const l=new Set,d=new Set;let g;try{g=o.getStorage()}catch{}if(!g)return n((...P)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),t(...P)},r,i);const h=kt(o.serialize),x=()=>{const P=o.partialize({...r()});let S;const w=h({state:P,version:o.version}).then(u=>g.setItem(o.name,u)).catch(u=>{S=u});if(S)throw S;return w},v=i.setState;i.setState=(P,S)=>{v(P,S),x()};const F=n((...P)=>{t(...P),x()},r,i);let k;const E=()=>{var P;if(!g)return;a=!1,l.forEach(w=>w(r()));const S=((P=o.onRehydrateStorage)==null?void 0:P.call(o,r()))||void 0;return kt(g.getItem.bind(g))(o.name).then(w=>{if(w)return o.deserialize(w)}).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==o.version){if(o.migrate)return o.migrate(w.state,w.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return w.state}).then(w=>{var u;return k=o.merge(w,(u=r())!=null?u:F),t(k,!0),x()}).then(()=>{S==null||S(k,void 0),a=!0,d.forEach(w=>w(k))}).catch(w=>{S==null||S(void 0,w)})};return i.persist={setOptions:P=>{o={...o,...P},P.getStorage&&(g=P.getStorage())},clearStorage:()=>{g==null||g.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>E(),hasHydrated:()=>a,onHydrate:P=>(l.add(P),()=>{l.delete(P)}),onFinishHydration:P=>(d.add(P),()=>{d.delete(P)})},E(),k||F},Oi=(n,e)=>(t,r,i)=>{let o={storage:Di(()=>localStorage),partialize:E=>E,version:0,merge:(E,P)=>({...P,...E}),...e},a=!1;const l=new Set,d=new Set;let g=o.storage;if(!g)return n((...E)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),t(...E)},r,i);const h=()=>{const E=o.partialize({...r()});return g.setItem(o.name,{state:E,version:o.version})},x=i.setState;i.setState=(E,P)=>{x(E,P),h()};const v=n((...E)=>{t(...E),h()},r,i);i.getInitialState=()=>v;let F;const k=()=>{var E,P;if(!g)return;a=!1,l.forEach(w=>{var u;return w((u=r())!=null?u:v)});const S=((P=o.onRehydrateStorage)==null?void 0:P.call(o,(E=r())!=null?E:v))||void 0;return kt(g.getItem.bind(g))(o.name).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==o.version){if(o.migrate)return[!0,o.migrate(w.state,w.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,w.state];return[!1,void 0]}).then(w=>{var u;const[se,ee]=w;if(F=o.merge(ee,(u=r())!=null?u:v),t(F,!0),se)return h()}).then(()=>{S==null||S(F,void 0),F=r(),a=!0,d.forEach(w=>w(F))}).catch(w=>{S==null||S(void 0,w)})};return i.persist={setOptions:E=>{o={...o,...E},E.storage&&(g=E.storage)},clearStorage:()=>{g==null||g.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>k(),hasHydrated:()=>a,onHydrate:E=>(l.add(E),()=>{l.delete(E)}),onFinishHydration:E=>(d.add(E),()=>{d.delete(E)})},o.skipHydration||k(),F||v},Ri=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((Fi?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Li(n,e)):Oi(n,e),Ui=Ri,Oe=zt()(Ui(n=>({darkMode:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,syncZoom:!0,syncDraw:!1,presentationMode:!1,visibleExifFields:["Make","Model","ISO","FNumber","ExposureTime","FocalLength","LensModel","DateTimeOriginal"],demoMode:!1,exifSettings:{FileName:!1,Resolution:!0,Make:!0,Model:!0,LensModel:!1,FocalLength:!0,FNumber:!0,ExposureTime:!0,ISO:!1,DateTimeOriginal:!1},showZoomControls:!1,showExifInfo:!0,toggleDarkMode:()=>n(e=>({darkMode:!e.darkMode})),toggleSyncZoom:()=>n(e=>({syncZoom:!e.syncZoom})),toggleSyncDraw:()=>n(e=>({syncDraw:!e.syncDraw})),togglePresentationMode:()=>n(e=>({presentationMode:!e.presentationMode})),toggleDemoMode:()=>n(e=>({demoMode:!e.demoMode})),toggleExifSetting:e=>n(t=>({exifSettings:{...t.exifSettings,[e]:!t.exifSettings[e]}})),toggleExifField:e=>n(t=>({visibleExifFields:t.visibleExifFields.includes(e)?t.visibleExifFields.filter(r=>r!==e):[...t.visibleExifFields,e]})),toggleAllExifSettings:e=>n(t=>{const r={...t.exifSettings};return Object.keys(r).forEach(i=>{r[i]=e}),{exifSettings:r}}),toggleShowZoomControls:()=>n(e=>({showZoomControls:!e.showZoomControls})),toggleShowExifInfo:()=>n(e=>({showExifInfo:!e.showExifInfo}))}),{name:"photo-compare-settings",partialize:n=>({darkMode:n.darkMode,syncZoom:n.syncZoom,syncDraw:n.syncDraw,presentationMode:n.presentationMode,visibleExifFields:n.visibleExifFields,demoMode:n.demoMode,exifSettings:n.exifSettings,showZoomControls:n.showZoomControls,showExifInfo:n.showExifInfo})})),ht=zt((n,e)=>({images:[],lastImageUrl:null,hasViewedImages:!1,addImages:t=>n(r=>({images:[...r.images,...t],hasViewedImages:!0})),addImage:t=>n(r=>({images:[...r.images,t],hasViewedImages:!0})),removeImage:t=>n(r=>{var o;const i=r.images.filter(a=>a.id!==t);return i.length===0&&r.images.length>0?{images:i,lastImageUrl:((o=r.images.find(a=>a.id===t))==null?void 0:o.url)||null}:{images:i}}),clearImages:()=>n({images:[]}),resetState:()=>n({images:[],lastImageUrl:null,hasViewedImages:!1})}));var Ht=typeof self<"u"?self:global;const St=typeof navigator<"u",Bi=St&&typeof HTMLImageElement>"u",Dt=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),Wt=Ht.Buffer,Pt=Ht.BigInt,_t=!!Wt,$i=n=>n;function Lt(n,e=$i){if(Dt)try{return typeof require=="function"?Promise.resolve(e(require(n))):import(n).then(e)}catch{console.warn(`Couldn't load ${n}`)}}let yn=Ht.fetch;const zi=n=>yn=n;if(!Ht.fetch){const n=Lt("http",r=>r),e=Lt("https",r=>r),t=(r,{headers:i}={})=>new Promise(async(o,a)=>{let{port:l,hostname:d,pathname:g,protocol:h,search:x}=new URL(r);const v={method:"GET",hostname:d,path:encodeURI(g)+x,headers:i};l!==""&&(v.port=Number(l));const F=(h==="https:"?await e:await n).request(v,k=>{if(k.statusCode===301||k.statusCode===302){let E=new URL(k.headers.location,r).toString();return t(E,{headers:i}).then(o).catch(a)}o({status:k.statusCode,arrayBuffer:()=>new Promise(E=>{let P=[];k.on("data",S=>P.push(S)),k.on("end",()=>E(Buffer.concat(P)))})})});F.on("error",a),F.end()});zi(t)}function K(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const Ot=n=>Ar(n)?void 0:n,Hi=n=>n!==void 0;function Ar(n){return n===void 0||(n instanceof Map?n.size===0:Object.values(n).filter(Hi).length===0)}function ve(n){let e=new Error(n);throw delete e.stack,e}function et(n){return(n=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(n).trim())===""?void 0:n}function an(n){let e=function(t){let r=0;return t.ifd0.enabled&&(r+=1024),t.exif.enabled&&(r+=2048),t.makerNote&&(r+=2048),t.userComment&&(r+=1024),t.gps.enabled&&(r+=512),t.interop.enabled&&(r+=100),t.ifd1.enabled&&(r+=1024),r+2048}(n);return n.jfif.enabled&&(e+=50),n.xmp.enabled&&(e+=2e4),n.iptc.enabled&&(e+=14e3),n.icc.enabled&&(e+=6e3),e}const ln=n=>String.fromCharCode.apply(null,n),Jn=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;function Tr(n){return Jn?Jn.decode(n):_t?Buffer.from(n).toString("utf8"):decodeURIComponent(escape(ln(n)))}let Ze=class ct{static from(e,t){return e instanceof this&&e.le===t?e:new ct(e,void 0,void 0,t)}constructor(e,t=0,r,i){if(typeof i=="boolean"&&(this.le=i),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){r===void 0&&(r=e.byteLength-t);let o=new DataView(e,t,r);this._swapDataView(o)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof ct){r===void 0&&(r=e.byteLength-t),(t+=e.byteOffset)+r>e.byteOffset+e.byteLength&&ve("Creating view outside of available memory in ArrayBuffer");let o=new DataView(e.buffer,t,r);this._swapDataView(o)}else if(typeof e=="number"){let o=new DataView(new ArrayBuffer(e));this._swapDataView(o)}else ve("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,r=ct){return e instanceof DataView||e instanceof ct?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||ve("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new r(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new ct(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return Tr(this.getUint8Array(e,t))}getLatin1String(e=0,t=this.byteLength){let r=this.getUint8Array(e,t);return ln(r)}getUnicodeString(e=0,t=this.byteLength){const r=[];for(let i=0;i<t&&e+i<this.byteLength;i+=2)r.push(this.getUint16(e+i));return ln(r)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,r){switch(t){case 1:return this.getUint8(e,r);case 2:return this.getUint16(e,r);case 4:return this.getUint32(e,r);case 8:return this.getUint64&&this.getUint64(e,r)}}getUint(e,t,r){switch(t){case 8:return this.getUint8(e,r);case 16:return this.getUint16(e,r);case 32:return this.getUint32(e,r);case 64:return this.getUint64&&this.getUint64(e,r)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}};function cn(n,e){ve(`${n} '${e}' was not loaded, try using full build of exifr.`)}class bn extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||cn(this.kind,e),t&&(e in t||function(r,i){ve(`Unknown ${r} '${i}'.`)}(this.kind,e),t[e].enabled||cn(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var Le=new bn("file parser"),be=new bn("segment parser"),Re=new bn("file reader");function Wi(n,e){return typeof n=="string"?qn(n,e):St&&!Bi&&n instanceof HTMLImageElement?qn(n.src,e):n instanceof Uint8Array||n instanceof ArrayBuffer||n instanceof DataView?new Ze(n):St&&n instanceof Blob?dn(n,e,"blob",it):void ve("Invalid input argument")}function qn(n,e){return(t=n).startsWith("data:")||t.length>1e4?un(n,e,"base64"):Dt&&n.includes("://")?dn(n,e,"url",rt):Dt?un(n,e,"fs"):St?dn(n,e,"url",rt):void ve("Invalid input argument");var t}async function dn(n,e,t,r){return Re.has(t)?un(n,e,t):r?async function(i,o){let a=await o(i);return new Ze(a)}(n,r):void ve(`Parser ${t} is not loaded`)}async function un(n,e,t){let r=new(Re.get(t))(n,e);return await r.read(),r}const rt=n=>yn(n).then(e=>e.arrayBuffer()),it=n=>new Promise((e,t)=>{let r=new FileReader;r.onloadend=()=>e(r.result||new ArrayBuffer),r.onerror=t,r.readAsArrayBuffer(n)});let _i=class extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}};function ye(n,e,t){let r=new _i;for(let[i,o]of t)r.set(i,o);if(Array.isArray(e))for(let i of e)n.set(i,r);else n.set(e,r);return r}function st(n,e,t){let r,i=n.get(e);for(r of t)i.set(r[0],r[1])}const je=new Map,De=new Map,Je=new Map,Ge=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],ft=["jfif","xmp","icc","iptc","ihdr"],ot=["tiff",...ft],me=["ifd0","ifd1","exif","gps","interop"],Xe=[...ot,...me],Ye=["makerNote","userComment"],gt=["translateKeys","translateValues","reviveValues","multiSegment"],Ke=[...gt,"sanitize","mergeOutput","silentErrors"];class Fr{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}let mt=class extends Fr{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,r,i){if(super(),K(this,"enabled",!1),K(this,"skip",new Set),K(this,"pick",new Set),K(this,"deps",new Set),K(this,"translateKeys",!1),K(this,"translateValues",!1),K(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(i),this.canBeFiltered=me.includes(e),this.canBeFiltered&&(this.dict=je.get(e)),r!==void 0)if(Array.isArray(r))this.parse=this.enabled=!0,this.canBeFiltered&&r.length>0&&this.translateTagSet(r,this.pick);else if(typeof r=="object"){if(this.enabled=!0,this.parse=r.parse!==!1,this.canBeFiltered){let{pick:o,skip:a}=r;o&&o.length>0&&this.translateTagSet(o,this.pick),a&&a.length>0&&this.translateTagSet(a,this.skip)}this.applyInheritables(r)}else r===!0||r===!1?this.parse=this.enabled=r:ve(`Invalid options argument: ${r}`)}applyInheritables(e){let t,r;for(t of gt)r=e[t],r!==void 0&&(this[t]=r)}translateTagSet(e,t){if(this.dict){let r,i,{tagKeys:o,tagValues:a}=this.dict;for(r of e)typeof r=="string"?(i=a.indexOf(r),i===-1&&(i=o.indexOf(Number(r))),i!==-1&&t.add(Number(o[i]))):t.add(r)}else for(let r of e)t.add(r)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,Rt(this.pick,this.deps)):this.enabled&&this.pick.size>0&&Rt(this.pick,this.deps)}};var Ae={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},Zn=new Map;let at=class extends Fr{static useCached(e){let t=Zn.get(e);return t!==void 0||(t=new this(e),Zn.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):ve(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=St?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of Ge)this[e]=Ae[e];for(e of Ke)this[e]=Ae[e];for(e of Ye)this[e]=Ae[e];for(e of Xe)this[e]=new mt(e,Ae[e],void 0,this)}setupFromTrue(){let e;for(e of Ge)this[e]=Ae[e];for(e of Ke)this[e]=Ae[e];for(e of Ye)this[e]=!0;for(e of Xe)this[e]=new mt(e,!0,void 0,this)}setupFromArray(e){let t;for(t of Ge)this[t]=Ae[t];for(t of Ke)this[t]=Ae[t];for(t of Ye)this[t]=Ae[t];for(t of Xe)this[t]=new mt(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,me)}setupFromObject(e){let t;for(t of(me.ifd0=me.ifd0||me.image,me.ifd1=me.ifd1||me.thumbnail,Object.assign(this,e),Ge))this[t]=Qt(e[t],Ae[t]);for(t of Ke)this[t]=Qt(e[t],Ae[t]);for(t of Ye)this[t]=Qt(e[t],Ae[t]);for(t of ot)this[t]=new mt(t,Ae[t],e[t],this);for(t of me)this[t]=new mt(t,Ae[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,me,Xe),e.tiff===!0?this.batchEnableWithBool(me,!0):e.tiff===!1?this.batchEnableWithUserValue(me,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,me):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,me)}batchEnableWithBool(e,t){for(let r of e)this[r].enabled=t}batchEnableWithUserValue(e,t){for(let r of e){let i=t[r];this[r].enabled=i!==!1&&i!==void 0}}setupGlobalFilters(e,t,r,i=r){if(e&&e.length){for(let a of i)this[a].enabled=!1;let o=Qn(e,r);for(let[a,l]of o)Rt(this[a].pick,l),this[a].enabled=!0}else if(t&&t.length){let o=Qn(t,r);for(let[a,l]of o)Rt(this[a].skip,l)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:r,iptc:i,icc:o}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),r.enabled||e.skip.add(700),i.enabled||e.skip.add(33723),o.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:r,interop:i}=this;i.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),r.needed&&e.deps.add(34853),this.tiff.enabled=me.some(o=>this[o].enabled===!0)||this.makerNote||this.userComment;for(let o of me)this[o].finalizeFilters()}get onlyTiff(){return!ft.map(e=>this[e].enabled).some(e=>e===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let e of ot)this[e].enabled&&!be.has(e)&&cn("segment parser",e)}};function Qn(n,e){let t,r,i,o,a=[];for(i of e){for(o of(t=je.get(i),r=[],t))(n.includes(o[0])||n.includes(o[1]))&&r.push(o[0]);r.length&&a.push([i,r])}return a}function Qt(n,e){return n!==void 0?n:e!==void 0?e:void 0}function Rt(n,e){for(let t of e)n.add(t)}K(at,"default",Ae);class Qe{constructor(e){K(this,"parsers",{}),K(this,"output",{}),K(this,"errors",[]),K(this,"pushToErrors",t=>this.errors.push(t)),this.options=at.useCached(e)}async read(e){this.file=await Wi(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[r,i]of Le)if(i.canHandle(e,t))return this.fileParser=new i(this.options,this.file,this.parsers),e[r]=!0;this.file.close&&this.file.close(),ve("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),Ot(e)}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map(async r=>{let i=await r.parse();r.assignToOutput(e,i)});this.options.silentErrors&&(t=t.map(r=>r.catch(this.pushToErrors))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,r=be.get("tiff",e);var i;if(t.tiff?i={start:0,type:"tiff"}:t.jpeg&&(i=await this.fileParser.getOrFindSegment("tiff")),i===void 0)return;let o=await this.fileParser.ensureSegmentChunk(i),a=this.parsers.tiff=new r(o,e,t),l=await a.extractThumbnail();return t.close&&t.close(),l}}async function Vt(n,e){let t=new Qe(e);return await t.read(n),t.parse()}var Vi=Object.freeze({__proto__:null,parse:Vt,Exifr:Qe,fileParsers:Le,segmentParsers:be,fileReaders:Re,tagKeys:je,tagValues:De,tagRevivers:Je,createDictionary:ye,extendDictionary:st,fetchUrlAsArrayBuffer:rt,readBlobAsArrayBuffer:it,chunkedProps:Ge,otherSegments:ft,segments:ot,tiffBlocks:me,segmentsAndBlocks:Xe,tiffExtractables:Ye,inheritables:gt,allFormatters:Ke,Options:at});class Gt{constructor(e,t,r){K(this,"errors",[]),K(this,"ensureSegmentChunk",async i=>{let o=i.start,a=i.size||65536;if(this.file.chunked)if(this.file.available(o,a))i.chunk=this.file.subarray(o,a);else try{i.chunk=await this.file.readChunk(o,a)}catch(l){ve(`Couldn't read segment: ${JSON.stringify(i)}. ${l.message}`)}else this.file.byteLength>o+a?i.chunk=this.file.subarray(o,a):i.size===void 0?i.chunk=this.file.subarray(o):ve("Segment unreachable: "+JSON.stringify(i));return i.chunk}),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=r}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let r=new(be.get(e))(t,this.options,this.file);return this.parsers[e]=r}createParsers(e){for(let t of e){let{type:r,chunk:i}=t,o=this.options[r];if(o&&o.enabled){let a=this.parsers[r];a&&a.append||a||this.createParser(r,i)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}class Fe{static findPosition(e,t){let r=e.getUint16(t+2)+2,i=typeof this.headerLength=="function"?this.headerLength(e,t,r):this.headerLength,o=t+i,a=r-i;return{offset:t,length:r,headerLength:i,start:o,size:a,end:o+a}}static parse(e,t={}){return new this(e,new at({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof Ze?e:new Ze(e)}constructor(e,t={},r){K(this,"errors",[]),K(this,"raw",new Map),K(this,"handleError",i=>{if(!this.options.silentErrors)throw i;this.errors.push(i.message)}),this.chunk=this.normalizeInput(e),this.file=r,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let r=Je.get(t),i=De.get(t),o=je.get(t),a=this.options[t],l=a.reviveValues&&!!r,d=a.translateValues&&!!i,g=a.translateKeys&&!!o,h={};for(let[x,v]of e)l&&r.has(x)?v=r.get(x)(v):d&&i.has(x)&&(v=this.translateValue(v,i.get(x))),g&&o.has(x)&&(x=o.get(x)||x),h[x]=v;return h}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,r){if(this.globalOptions.mergeOutput)return Object.assign(e,r);e[t]?Object.assign(e[t],r):e[t]=r}}K(Fe,"headerLength",4),K(Fe,"type",void 0),K(Fe,"multiSegment",!1),K(Fe,"canHandle",()=>!1);function Gi(n){return n===192||n===194||n===196||n===219||n===221||n===218||n===254}function Xi(n){return n>=224&&n<=239}function Yi(n,e,t){for(let[r,i]of be)if(i.canHandle(n,e,t))return r}class er extends Gt{constructor(...e){super(...e),K(this,"appSegments",[]),K(this,"jpegSegments",[]),K(this,"unknownSegments",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(be.keyList())):(e=e===void 0?be.keyList().filter(t=>this.options[t].enabled):e.filter(t=>this.options[t].enabled&&be.has(t)),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:r,findAll:i,wanted:o,remaining:a}=this;if(!i&&this.file.chunked&&(i=Array.from(o).some(l=>{let d=be.get(l),g=this.options[l];return d.multiSegment&&g.multiSegment}),i&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,r.byteLength),!this.options.onlyTiff&&r.chunked){let l=!1;for(;a.size>0&&!l&&(r.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:d}=r,g=this.appSegments.some(h=>!this.file.available(h.offset||h.start,h.length||h.size));if(l=e>d&&!g?!await r.readNextChunk(e):!await r.readNextChunk(d),(e=this.findAppSegmentsInRange(e,r.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let r,i,o,a,l,d,{file:g,findAll:h,wanted:x,remaining:v,options:F}=this;for(;e<t;e++)if(g.getUint8(e)===255){if(r=g.getUint8(e+1),Xi(r)){if(i=g.getUint16(e+2),o=Yi(g,e,i),o&&x.has(o)&&(a=be.get(o),l=a.findPosition(g,e),d=F[o],l.type=o,this.appSegments.push(l),!h&&(a.multiSegment&&d.multiSegment?(this.unfinishedMultiSegment=l.chunkNumber<l.chunkCount,this.unfinishedMultiSegment||v.delete(o)):v.delete(o),v.size===0)))break;F.recordUnknownSegments&&(l=Fe.findPosition(g,e),l.marker=r,this.unknownSegments.push(l)),e+=i+1}else if(Gi(r)){if(i=g.getUint16(e+2),r===218&&F.stopAfterSos!==!1)return;F.recordJpegSegments&&this.jpegSegments.push({offset:e,length:i,marker:r}),e+=i+1}}return e}mergeMultiSegments(){if(!this.appSegments.some(t=>t.multiSegment))return;let e=function(t,r){let i,o,a,l=new Map;for(let d=0;d<t.length;d++)i=t[d],o=i[r],l.has(o)?a=l.get(o):l.set(o,a=[]),a.push(i);return Array.from(l)}(this.appSegments,"type");this.mergedAppSegments=e.map(([t,r])=>{let i=be.get(t,this.options);return i.handleMultiSegments?{type:t,chunk:i.handleMultiSegments(r)}:r[0]})}getSegment(e){return this.appSegments.find(t=>t.type===e)}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}K(er,"type","jpeg"),Le.set("jpeg",er);const Ki=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class Ji extends Fe{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,r=new Map){let{pick:i,skip:o}=this.options[t];i=new Set(i);let a=i.size>0,l=o.size===0,d=this.chunk.getUint16(e);e+=2;for(let g=0;g<d;g++){let h=this.chunk.getUint16(e);if(a){if(i.has(h)&&(r.set(h,this.parseTag(e,h,t)),i.delete(h),i.size===0))break}else!l&&o.has(h)||r.set(h,this.parseTag(e,h,t));e+=12}return r}parseTag(e,t,r){let{chunk:i}=this,o=i.getUint16(e+2),a=i.getUint32(e+4),l=Ki[o];if(l*a<=4?e+=8:e=i.getUint32(e+8),(o<1||o>13)&&ve(`Invalid TIFF value type. block: ${r.toUpperCase()}, tag: ${t.toString(16)}, type: ${o}, offset ${e}`),e>i.byteLength&&ve(`Invalid TIFF value offset. block: ${r.toUpperCase()}, tag: ${t.toString(16)}, type: ${o}, offset ${e} is outside of chunk size ${i.byteLength}`),o===1)return i.getUint8Array(e,a);if(o===2)return et(i.getString(e,a));if(o===7)return i.getUint8Array(e,a);if(a===1)return this.parseTagValue(o,e);{let d=new(function(h){switch(h){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(o))(a),g=l;for(let h=0;h<a;h++)d[h]=this.parseTagValue(o,e),e+=g;return d}}parseTagValue(e,t){let{chunk:r}=this;switch(e){case 1:return r.getUint8(t);case 3:return r.getUint16(t);case 4:return r.getUint32(t);case 5:return r.getUint32(t)/r.getUint32(t+4);case 6:return r.getInt8(t);case 8:return r.getInt16(t);case 9:return r.getInt32(t);case 10:return r.getInt32(t)/r.getInt32(t+4);case 11:return r.getFloat(t);case 12:return r.getDouble(t);case 13:return r.getUint32(t);default:ve(`Invalid tiff type ${e}`)}}}class en extends Ji{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let r=new Map;return this[t]=r,this.parseTags(e,t,r),r}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&ve("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&ve(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,an(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,an(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let r=e.get(t);r&&r.length===1&&e.set(t,r[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",tr(...e.get(2),e.get(1))),e.set("longitude",tr(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,r,i={};for(t of me)if(e=this[t],!Ar(e))if(r=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t==="ifd1")continue;Object.assign(i,r)}else i[t]=r;return this.makerNote&&(i.makerNote=this.makerNote),this.userComment&&(i.userComment=this.userComment),i}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[r,i]of Object.entries(t))this.assignObjectToOutput(e,r,i)}}function tr(n,e,t,r){var i=n+e/60+t/3600;return r!=="S"&&r!=="W"||(i*=-1),i}K(en,"type","tiff"),K(en,"headerLength",10),be.set("tiff",en);var qi=Object.freeze({__proto__:null,default:Vi,Exifr:Qe,fileParsers:Le,segmentParsers:be,fileReaders:Re,tagKeys:je,tagValues:De,tagRevivers:Je,createDictionary:ye,extendDictionary:st,fetchUrlAsArrayBuffer:rt,readBlobAsArrayBuffer:it,chunkedProps:Ge,otherSegments:ft,segments:ot,tiffBlocks:me,segmentsAndBlocks:Xe,tiffExtractables:Ye,inheritables:gt,allFormatters:Ke,Options:at,parse:Vt});const vn={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},wn=Object.assign({},vn,{firstChunkSize:4e4,gps:[1,2,3,4]});async function Dr(n){let e=new Qe(wn);await e.read(n);let t=await e.parse();if(t&&t.gps){let{latitude:r,longitude:i}=t.gps;return{latitude:r,longitude:i}}}const kn=Object.assign({},vn,{tiff:!1,ifd1:!0,mergeOutput:!1});async function Lr(n){let e=new Qe(kn);await e.read(n);let t=await e.extractThumbnail();return t&&_t?Wt.from(t):t}async function Or(n){let e=await this.thumbnail(n);if(e!==void 0){let t=new Blob([e]);return URL.createObjectURL(t)}}const Sn=Object.assign({},vn,{firstChunkSize:4e4,ifd0:[274]});async function Cn(n){let e=new Qe(Sn);await e.read(n);let t=await e.parse();if(t&&t.ifd0)return t.ifd0[274]}const jn=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let tt=!0,nt=!0;if(typeof navigator=="object"){let n=navigator.userAgent;if(n.includes("iPad")||n.includes("iPhone")){let e=n.match(/OS (\d+)_(\d+)/);if(e){let[,t,r]=e;tt=Number(t)+.1*Number(r)<13.4,nt=!1}}else if(n.includes("OS X 10")){let[,e]=n.match(/OS X 10[_.](\d+)/);tt=nt=Number(e)<15}if(n.includes("Chrome/")){let[,e]=n.match(/Chrome\/(\d+)/);tt=nt=Number(e)<81}else if(n.includes("Firefox/")){let[,e]=n.match(/Firefox\/(\d+)/);tt=nt=Number(e)<77}}async function Rr(n){let e=await Cn(n);return Object.assign({canvas:tt,css:nt},jn[e])}class Zi extends Ze{constructor(...e){super(...e),K(this,"ranges",new Qi),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,r){if(e===0&&this.byteLength===0&&r){let i=new DataView(r.buffer||r,r.byteOffset,r.byteLength);this._swapDataView(i)}else{let i=e+t;if(i>this.byteLength){let{dataView:o}=this._extend(i);this._swapDataView(o)}}}_extend(e){let t;t=_t?Wt.allocUnsafe(e):new Uint8Array(e);let r=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:r}}subarray(e,t,r=!1){return t=t||this._lengthToEnd(e),r&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,r=!1){r&&this._tryExtend(t,e.byteLength,e);let i=super.set(e,t);return this.ranges.add(t,i.byteLength),i}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class Qi{constructor(){K(this,"list",[])}get length(){return this.list.length}add(e,t,r=0){let i=e+t,o=this.list.filter(a=>nr(e,a.offset,i)||nr(e,a.end,i));if(o.length>0){e=Math.min(e,...o.map(l=>l.offset)),i=Math.max(i,...o.map(l=>l.end)),t=i-e;let a=o.shift();a.offset=e,a.length=t,a.end=i,this.list=this.list.filter(l=>!o.includes(l))}else this.list.push({offset:e,length:t,end:i})}available(e,t){let r=e+t;return this.list.some(i=>i.offset<=e&&r<=i.end)}}function nr(n,e,t){return n<=e&&e<=t}class Xt extends Zi{constructor(e,t){super(0),K(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,r=await this.readChunk(e,t);return!!r&&r.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}Re.set("blob",class extends Xt{async readWhole(){this.chunked=!1;let n=await it(this.input);this._swapArrayBuffer(n)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(n,e){let t=e?n+e:void 0,r=this.input.slice(n,t),i=await it(r);return this.set(i,n,!0)}});var es=Object.freeze({__proto__:null,default:qi,Exifr:Qe,fileParsers:Le,segmentParsers:be,fileReaders:Re,tagKeys:je,tagValues:De,tagRevivers:Je,createDictionary:ye,extendDictionary:st,fetchUrlAsArrayBuffer:rt,readBlobAsArrayBuffer:it,chunkedProps:Ge,otherSegments:ft,segments:ot,tiffBlocks:me,segmentsAndBlocks:Xe,tiffExtractables:Ye,inheritables:gt,allFormatters:Ke,Options:at,parse:Vt,gpsOnlyOptions:wn,gps:Dr,thumbnailOnlyOptions:kn,thumbnail:Lr,thumbnailUrl:Or,orientationOnlyOptions:Sn,orientation:Cn,rotations:jn,get rotateCanvas(){return tt},get rotateCss(){return nt},rotation:Rr});Re.set("url",class extends Xt{async readWhole(){this.chunked=!1;let n=await rt(this.input);n instanceof ArrayBuffer?this._swapArrayBuffer(n):n instanceof Uint8Array&&this._swapBuffer(n)}async _readChunk(n,e){let t=e?n+e-1:void 0,r=this.options.httpHeaders||{};(n||t)&&(r.range=`bytes=${[n,t].join("-")}`);let i=await yn(this.input,{headers:r}),o=await i.arrayBuffer(),a=o.byteLength;if(i.status!==416)return a!==e&&(this.size=n+a),this.set(o,n,!0)}});Ze.prototype.getUint64=function(n){let e=this.getUint32(n),t=this.getUint32(n+4);return e<1048575?e<<32|t:typeof Pt!==void 0?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),Pt(e)<<Pt(32)|Pt(t)):void ve("Trying to read 64b value but JS can only handle 53b numbers.")};class ts extends Gt{parseBoxes(e=0){let t=[];for(;e<this.file.byteLength-4;){let r=this.parseBoxHead(e);if(t.push(r),r.length===0)break;e+=r.length}return t}parseSubBoxes(e){e.boxes=this.parseBoxes(e.start)}findBox(e,t){return e.boxes===void 0&&this.parseSubBoxes(e),e.boxes.find(r=>r.kind===t)}parseBoxHead(e){let t=this.file.getUint32(e),r=this.file.getString(e+4,4),i=e+8;return t===1&&(t=this.file.getUint64(e+8),i+=8),{offset:e,length:t,kind:r,start:i}}parseBoxFullHead(e){if(e.version!==void 0)return;let t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}class Ur extends ts{static canHandle(e,t){if(t!==0)return!1;let r=e.getUint16(2);if(r>50)return!1;let i=16,o=[];for(;i<r;)o.push(e.getString(i,4)),i+=4;return o.includes(this.type)}async parse(){let e=this.file.getUint32(0),t=this.parseBoxHead(e);for(;t.kind!=="meta";)e+=t.length,await this.file.ensureChunk(e,16),t=this.parseBoxHead(e);await this.file.ensureChunk(t.offset,t.length),this.parseBoxFullHead(t),this.parseSubBoxes(t),this.options.icc.enabled&&await this.findIcc(t),this.options.tiff.enabled&&await this.findExif(t)}async registerSegment(e,t,r){await this.file.ensureChunk(t,r);let i=this.file.subarray(t,r);this.createParser(e,i)}async findIcc(e){let t=this.findBox(e,"iprp");if(t===void 0)return;let r=this.findBox(t,"ipco");if(r===void 0)return;let i=this.findBox(r,"colr");i!==void 0&&await this.registerSegment("icc",i.offset+12,i.length)}async findExif(e){let t=this.findBox(e,"iinf");if(t===void 0)return;let r=this.findBox(e,"iloc");if(r===void 0)return;let i=this.findExifLocIdInIinf(t),o=this.findExtentInIloc(r,i);if(o===void 0)return;let[a,l]=o;await this.file.ensureChunk(a,l);let d=4+this.file.getUint32(a);a+=d,l-=d,await this.registerSegment("tiff",a,l)}findExifLocIdInIinf(e){this.parseBoxFullHead(e);let t,r,i,o,a=e.start,l=this.file.getUint16(a);for(a+=2;l--;){if(t=this.parseBoxHead(a),this.parseBoxFullHead(t),r=t.start,t.version>=2&&(i=t.version===3?4:2,o=this.file.getString(r+i+2,4),o==="Exif"))return this.file.getUintBytes(r,i);a+=t.length}}get8bits(e){let t=this.file.getUint8(e);return[t>>4,15&t]}findExtentInIloc(e,t){this.parseBoxFullHead(e);let r=e.start,[i,o]=this.get8bits(r++),[a,l]=this.get8bits(r++),d=e.version===2?4:2,g=e.version===1||e.version===2?2:0,h=l+i+o,x=e.version===2?4:2,v=this.file.getUintBytes(r,x);for(r+=x;v--;){let F=this.file.getUintBytes(r,d);r+=d+g+2+a;let k=this.file.getUint16(r);if(r+=2,F===t)return k>1&&console.warn(`ILOC box has more than one extent but we're only processing one
Please create an issue at https://github.com/MikeKovarik/exifr with this file`),[this.file.getUintBytes(r+l,i),this.file.getUintBytes(r+l+i,o)];r+=k*h}}}class Br extends Ur{}K(Br,"type","heic");class rr extends Ur{}K(rr,"type","avif"),Le.set("heic",Br),Le.set("avif",rr),ye(je,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),ye(je,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),ye(je,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),ye(De,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let vt=ye(De,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const ir={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};vt.set(37392,ir),vt.set(41488,ir);const tn={0:"Normal",1:"Low",2:"High"};function sr(n){return typeof n=="object"&&n.length!==void 0?n[0]:n}function or(n){let e=Array.from(n).slice(1);return e[1]>15&&(e=e.map(t=>String.fromCharCode(t))),e[2]!=="0"&&e[2]!==0||e.pop(),e.join(".")}function nn(n){if(typeof n=="string"){var[e,t,r,i,o,a]=n.trim().split(/[-: ]/g).map(Number),l=new Date(e,t-1,r);return Number.isNaN(i)||Number.isNaN(o)||Number.isNaN(a)||(l.setHours(i),l.setMinutes(o),l.setSeconds(a)),Number.isNaN(+l)?n:l}}function xt(n){if(typeof n=="string")return n;let e=[];if(n[1]===0&&n[n.length-1]===0)for(let t=0;t<n.length;t+=2)e.push(ar(n[t+1],n[t]));else for(let t=0;t<n.length;t+=2)e.push(ar(n[t],n[t+1]));return et(String.fromCodePoint(...e))}function ar(n,e){return n<<8|e}vt.set(41992,tn),vt.set(41993,tn),vt.set(41994,tn),ye(Je,["ifd0","ifd1"],[[50827,function(n){return typeof n!="string"?Tr(n):n}],[306,nn],[40091,xt],[40092,xt],[40093,xt],[40094,xt],[40095,xt]]),ye(Je,"exif",[[40960,or],[36864,or],[36867,nn],[36868,nn],[40962,sr],[40963,sr]]),ye(Je,"gps",[[0,n=>Array.from(n).join(".")],[7,n=>Array.from(n).join(":")]]);class rn extends Fe{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1752462448&&e.getString(t+4,20)==="http://ns.adobe.com/"}static headerLength(e,t){return e.getString(t+4,34)==="http://ns.adobe.com/xmp/extension/"?79:33}static findPosition(e,t){let r=super.findPosition(e,t);return r.multiSegment=r.extended=r.headerLength===79,r.multiSegment?(r.chunkCount=e.getUint8(t+72),r.chunkNumber=e.getUint8(t+76),e.getUint8(t+77)!==0&&r.chunkNumber++):(r.chunkCount=1/0,r.chunkNumber=-1),r}static handleMultiSegments(e){return e.map(t=>t.chunk.getString()).join("")}normalizeInput(e){return typeof e=="string"?e:Ze.from(e).getString()}parse(e=this.chunk){if(!this.localOptions.parse)return e;e=function(o){let a={},l={};for(let d of Wr)a[d]=[],l[d]=0;return o.replace(ss,(d,g,h)=>{if(g==="<"){let x=++l[h];return a[h].push(x),`${d}#${x}`}return`${d}#${a[h].pop()}`})}(e);let t=dt.findAll(e,"rdf","Description");t.length===0&&t.push(new dt("rdf","Description",void 0,e));let r,i={};for(let o of t)for(let a of o.properties)r=is(a.ns,i),$r(a,r);return function(o){let a;for(let l in o)a=o[l]=Ot(o[l]),a===void 0&&delete o[l];return Ot(o)}(i)}assignToOutput(e,t){if(this.localOptions.parse)for(let[r,i]of Object.entries(t))switch(r){case"tiff":this.assignObjectToOutput(e,"ifd0",i);break;case"exif":this.assignObjectToOutput(e,"exif",i);break;case"xmlns":break;default:this.assignObjectToOutput(e,r,i)}else e.xmp=t}}K(rn,"type","xmp"),K(rn,"multiSegment",!0),be.set("xmp",rn);class Ut{static findAll(e){return zr(e,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(Ut.unpackMatch)}static unpackMatch(e){let t=e[1],r=e[2],i=e[3].slice(1,-1);return i=Hr(i),new Ut(t,r,i)}constructor(e,t,r){this.ns=e,this.name=t,this.value=r}serialize(){return this.value}}class dt{static findAll(e,t,r){if(t!==void 0||r!==void 0){t=t||"[\\w\\d-]+",r=r||"[\\w\\d-]+";var i=new RegExp(`<(${t}):(${r})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else i=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return zr(e,i).map(dt.unpackMatch)}static unpackMatch(e){let t=e[1],r=e[2],i=e[4],o=e[8];return new dt(t,r,i,o)}constructor(e,t,r,i){this.ns=e,this.name=t,this.attrString=r,this.innerXml=i,this.attrs=Ut.findAll(r),this.children=dt.findAll(i),this.value=this.children.length===0?Hr(i):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return this.value!==void 0&&this.attrs.length===0&&this.children.length===0}get isListContainer(){return this.children.length===1&&this.children[0].isList}get isList(){let{ns:e,name:t}=this;return e==="rdf"&&(t==="Seq"||t==="Bag"||t==="Alt")}get isListItem(){return this.ns==="rdf"&&this.name==="li"}serialize(){if(this.properties.length===0&&this.value===void 0)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return rs(this.children.map(ns));if(this.isListItem&&this.children.length===1&&this.attrs.length===0)return this.children[0].serialize();let e={};for(let t of this.properties)$r(t,e);return this.value!==void 0&&(e.value=this.value),Ot(e)}}function $r(n,e){let t=n.serialize();t!==void 0&&(e[n.name]=t)}var ns=n=>n.serialize(),rs=n=>n.length===1?n[0]:n,is=(n,e)=>e[n]?e[n]:e[n]={};function zr(n,e){let t,r=[];if(!n)return r;for(;(t=e.exec(n))!==null;)r.push(t);return r}function Hr(n){if(function(r){return r==null||r==="null"||r==="undefined"||r===""||r.trim()===""}(n))return;let e=Number(n);if(!Number.isNaN(e))return e;let t=n.toLowerCase();return t==="true"||t!=="false"&&n.trim()}const Wr=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],ss=new RegExp(`(<|\\/)(${Wr.join("|")})`,"g");var os=Object.freeze({__proto__:null,default:es,Exifr:Qe,fileParsers:Le,segmentParsers:be,fileReaders:Re,tagKeys:je,tagValues:De,tagRevivers:Je,createDictionary:ye,extendDictionary:st,fetchUrlAsArrayBuffer:rt,readBlobAsArrayBuffer:it,chunkedProps:Ge,otherSegments:ft,segments:ot,tiffBlocks:me,segmentsAndBlocks:Xe,tiffExtractables:Ye,inheritables:gt,allFormatters:Ke,Options:at,parse:Vt,gpsOnlyOptions:wn,gps:Dr,thumbnailOnlyOptions:kn,thumbnail:Lr,thumbnailUrl:Or,orientationOnlyOptions:Sn,orientation:Cn,rotations:jn,get rotateCanvas(){return tt},get rotateCss(){return nt},rotation:Rr});let lr=Lt("fs",n=>n.promises);Re.set("fs",class extends Xt{async readWhole(){this.chunked=!1,this.fs=await lr;let n=await this.fs.readFile(this.input);this._swapBuffer(n)}async readChunked(){this.chunked=!0,this.fs=await lr,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){this.fh===void 0&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(n,e){this.fh===void 0&&await this.open(),n+e>this.size&&(e=this.size-n);var t=this.subarray(n,e,!0);return await this.fh.read(t.dataView,0,e,n),t}async close(){if(this.fh){let n=this.fh;this.fh=void 0,await n.close()}}});Re.set("base64",class extends Xt{constructor(...n){super(...n),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(n,e){let t,r,i=this.input;n===void 0?(n=0,t=0,r=0):(t=4*Math.floor(n/3),r=n-t/4*3),e===void 0&&(e=this.size);let o=n+e,a=t+4*Math.ceil(o/3);i=i.slice(t,a);let l=Math.min(e,this.size-n);if(_t){let d=Wt.from(i,"base64").slice(r,r+l);return this.set(d,n,!0)}{let d=this.subarray(n,l,!0),g=atob(i),h=d.toUint8();for(let x=0;x<l;x++)h[x]=g.charCodeAt(r+x);return d}}});class cr extends Gt{static canHandle(e,t){return t===18761||t===19789}extendOptions(e){let{ifd0:t,xmp:r,iptc:i,icc:o}=e;r.enabled&&t.deps.add(700),i.enabled&&t.deps.add(33723),o.enabled&&t.deps.add(34675),t.finalizeFilters()}async parse(){let{tiff:e,xmp:t,iptc:r,icc:i}=this.options;if(e.enabled||t.enabled||r.enabled||i.enabled){let o=Math.max(an(this.options),this.options.chunkSize);await this.file.ensureChunk(0,o),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(e){if(this.parsers.tiff[e]){let t=this.parsers.tiff[e];this.injectSegment(e,t)}}}K(cr,"type","tiff"),Le.set("tiff",cr);let as=Lt("zlib");const ls=["ihdr","iccp","text","itxt","exif"];class dr extends Gt{constructor(...e){super(...e),K(this,"catchError",t=>this.errors.push(t)),K(this,"metaChunks",[]),K(this,"unknownChunks",[])}static canHandle(e,t){return t===35152&&e.getUint32(0)===2303741511&&e.getUint32(4)===218765834}async parse(){let{file:e}=this;await this.findPngChunksInRange(8,e.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(e,t){let{file:r}=this;for(;e<t;){let i=r.getUint32(e),o=r.getUint32(e+4),a=r.getString(e+4,4).toLowerCase(),l=i+4+4+4,d={type:a,offset:e,length:l,start:e+4+4,size:i,marker:o};ls.includes(a)?this.metaChunks.push(d):this.unknownChunks.push(d),e+=l}}parseTextChunks(){let e=this.metaChunks.filter(t=>t.type==="text");for(let t of e){let[r,i]=this.file.getString(t.start,t.size).split("\0");this.injectKeyValToIhdr(r,i)}}injectKeyValToIhdr(e,t){let r=this.parsers.ihdr;r&&r.raw.set(e,t)}findIhdr(){let e=this.metaChunks.find(t=>t.type==="ihdr");e&&this.options.ihdr.enabled!==!1&&this.createParser("ihdr",e.chunk)}async findExif(){let e=this.metaChunks.find(t=>t.type==="exif");e&&this.injectSegment("tiff",e.chunk)}async findXmp(){let e=this.metaChunks.filter(t=>t.type==="itxt");for(let t of e)t.chunk.getString(0,17)==="XML:com.adobe.xmp"&&this.injectSegment("xmp",t.chunk)}async findIcc(){let e=this.metaChunks.find(l=>l.type==="iccp");if(!e)return;let{chunk:t}=e,r=t.getUint8Array(0,81),i=0;for(;i<80&&r[i]!==0;)i++;let o=i+2,a=t.getString(0,i);if(this.injectKeyValToIhdr("ProfileName",a),Dt){let l=await as,d=t.getUint8Array(o);d=l.inflateSync(d),this.injectSegment("icc",d)}}}K(dr,"type","png"),Le.set("png",dr),ye(je,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),st(je,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);let ur=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];st(je,"ifd0",ur),st(je,"exif",ur),ye(De,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);class sn extends Fe{static canHandle(e,t){return e.getUint8(t+1)===224&&e.getUint32(t+4)===1246120262&&e.getUint8(t+8)===0}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}K(sn,"type","jfif"),K(sn,"headerLength",9),be.set("jfif",sn),ye(je,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);class hr extends Fe{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}}K(hr,"type","ihdr"),be.set("ihdr",hr),ye(je,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),ye(De,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);class Ft extends Fe{static canHandle(e,t){return e.getUint8(t+1)===226&&e.getUint32(t+4)===1229144927}static findPosition(e,t){let r=super.findPosition(e,t);return r.chunkNumber=e.getUint8(t+16),r.chunkCount=e.getUint8(t+17),r.multiSegment=r.chunkCount>1,r}static handleMultiSegments(e){return function(t){let r=function(i){let o=i[0].constructor,a=0;for(let g of i)a+=g.length;let l=new o(a),d=0;for(let g of i)l.set(g,d),d+=g.length;return l}(t.map(i=>i.chunk.toUint8()));return new Ze(r)}(e)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:e}=this;this.chunk.byteLength<84&&ve("ICC header is too short");for(let[t,r]of Object.entries(cs)){t=parseInt(t,10);let i=r(this.chunk,t);i!=="\0\0\0\0"&&e.set(t,i)}}parseTags(){let e,t,r,i,o,{raw:a}=this,l=this.chunk.getUint32(128),d=132,g=this.chunk.byteLength;for(;l--;){if(e=this.chunk.getString(d,4),t=this.chunk.getUint32(d+4),r=this.chunk.getUint32(d+8),i=this.chunk.getString(t,4),t+r>g)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");o=this.parseTag(i,t,r),o!==void 0&&o!=="\0\0\0\0"&&a.set(e,o),d+=12}}parseTag(e,t,r){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,r);case"sig ":return this.parseSig(t)}if(!(t+r>this.chunk.byteLength))return this.chunk.getUint8Array(t,r)}parseDesc(e){let t=this.chunk.getUint32(e+8)-1;return et(this.chunk.getString(e+12,t))}parseText(e,t){return et(this.chunk.getString(e+8,t-8))}parseSig(e){return et(this.chunk.getString(e+8,4))}parseMluc(e){let{chunk:t}=this,r=t.getUint32(e+8),i=t.getUint32(e+12),o=e+16,a=[];for(let l=0;l<r;l++){let d=t.getString(o+0,2),g=t.getString(o+2,2),h=t.getUint32(o+4),x=t.getUint32(o+8)+e,v=et(t.getUnicodeString(x,h));a.push({lang:d,country:g,text:v}),o+=i}return r===1?a[0].text:a}translateValue(e,t){return typeof e=="string"?t[e]||t[e.toLowerCase()]||e:t[e]||e}}K(Ft,"type","icc"),K(Ft,"multiSegment",!0),K(Ft,"headerLength",18);const cs={4:$e,8:function(n,e){return[n.getUint8(e),n.getUint8(e+1)>>4,n.getUint8(e+1)%16].map(t=>t.toString(10)).join(".")},12:$e,16:$e,20:$e,24:function(n,e){const t=n.getUint16(e),r=n.getUint16(e+2)-1,i=n.getUint16(e+4),o=n.getUint16(e+6),a=n.getUint16(e+8),l=n.getUint16(e+10);return new Date(Date.UTC(t,r,i,o,a,l))},36:$e,40:$e,48:$e,52:$e,64:(n,e)=>n.getUint32(e),80:$e};function $e(n,e){return et(n.getString(e,4))}be.set("icc",Ft),ye(je,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);const Et={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},fr={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};ye(De,"icc",[[4,Et],[12,fr],[40,Object.assign({},Et,fr)],[48,Et],[80,Et],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);class Nt extends Fe{static canHandle(e,t,r){return e.getUint8(t+1)===237&&e.getString(t+4,9)==="Photoshop"&&this.containsIptc8bim(e,t,r)!==void 0}static headerLength(e,t,r){let i,o=this.containsIptc8bim(e,t,r);if(o!==void 0)return i=e.getUint8(t+o+7),i%2!=0&&(i+=1),i===0&&(i=4),o+8+i}static containsIptc8bim(e,t,r){for(let i=0;i<r;i++)if(this.isIptcSegmentHead(e,t+i))return i}static isIptcSegmentHead(e,t){return e.getUint8(t)===56&&e.getUint32(t)===943868237&&e.getUint16(t+4)===1028}parse(){let{raw:e}=this,t=this.chunk.byteLength-1,r=!1;for(let i=0;i<t;i++)if(this.chunk.getUint8(i)===28&&this.chunk.getUint8(i+1)===2){r=!0;let o=this.chunk.getUint16(i+3),a=this.chunk.getUint8(i+2),l=this.chunk.getLatin1String(i+5,o);e.set(a,this.pluralizeValue(e.get(a),l)),i+=4+o}else if(r)break;return this.translate(),this.output}pluralizeValue(e,t){return e!==void 0?e instanceof Array?(e.push(t),e):[e,t]:t}}K(Nt,"type","iptc"),K(Nt,"translateValues",!1),K(Nt,"reviveValues",!1),be.set("iptc",Nt),ye(je,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),ye(De,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]);const ds=async n=>{try{return await ei(n)}catch(e){console.warn("HEIC:",e);const t=n.name.toLowerCase();return t.endsWith(".heic")||t.endsWith(".heif")}},us=async(n,e=.85,t)=>{typeof t=="function"&&t(10);try{console.log("HEIC:",n.name);const r=await Sr({blob:n,type:"image/jpeg",quality:e});return typeof t=="function"&&t(100),console.log("HEIC:",n.name),r instanceof Blob?r:new Blob([r],{type:"image/jpeg"})}catch(r){console.error("HEICJPEG:",r),typeof t=="function"&&t(50);try{return console.log("HEIC:",n.name),await new Promise((i,o)=>{const a=new FileReader;a.onload=l=>{const d=new Image;d.onload=()=>{const g=document.createElement("canvas");g.width=d.width,g.height=d.height;const h=g.getContext("2d");if(!h){o(new Error("Canvas"));return}h.drawImage(d,0,0),typeof t=="function"&&t(90),g.toBlob(x=>{x?(typeof t=="function"&&t(100),i(x)):o(new Error("Canvas"))},"image/jpeg",e)},d.onerror=()=>{o(new Error(""))},d.src=URL.createObjectURL(n)},a.onerror=()=>{o(new Error(""))},a.readAsArrayBuffer(n)})}catch(i){throw console.error(":",i),new Error("HEICJPEG")}}},hs=async(n,e)=>{typeof e=="function"&&e(10);try{console.log("HEICPNG:",n.name);const t=await Sr({blob:n,type:"image/png",quality:1});return typeof e=="function"&&e(100),console.log("HEICPNG:",n.name),t instanceof Blob?t:new Blob([t],{type:"image/png"})}catch(t){console.error("HEICPNG:",t),typeof e=="function"&&e(50);try{return console.log("HEICPNG:",n.name),await new Promise((r,i)=>{const o=new FileReader;o.onload=a=>{const l=new Image;l.onload=()=>{const d=document.createElement("canvas");d.width=l.width,d.height=l.height;const g=d.getContext("2d");if(!g){i(new Error("Canvas"));return}g.drawImage(l,0,0),typeof e=="function"&&e(90),d.toBlob(h=>{h?(typeof e=="function"&&e(100),r(h)):i(new Error("Canvas"))},"image/png")},l.onerror=()=>{i(new Error(""))},l.src=URL.createObjectURL(n)},o.onerror=()=>{i(new Error(""))},o.readAsArrayBuffer(n)})}catch(r){throw console.error(":",r),new Error("HEICJPEG")}}},fs=async(n,e="image/jpeg",t=.85,r)=>{try{return e==="image/png"?hs(n,r):us(n,t,r)}catch(i){throw console.error("HEIC:",i),typeof r=="function"&&r(100),i}},hn=async n=>{var e;try{const t=URL.createObjectURL(n),r=await new Promise(o=>{const a=new Image;a.onload=()=>{o({width:a.naturalWidth,height:a.naturalHeight})},a.onerror=()=>{o({width:0,height:0})},a.src=t,setTimeout(()=>o({width:0,height:0}),3e3)});let i={};try{i=await os.parse(n,{pick:["Make","Model","LensModel","FocalLength","FNumber","ExposureTime","ISO","DateTimeOriginal"]})||{}}catch(o){console.warn("EXIF:",o)}return{id:`${Date.now()}-${Math.random().toString(36).substring(2)}-${n.name}`,file:n,url:t,name:n.name,exif:{FileName:n.name,Resolution:`${r.width}  ${r.height}`,Make:(i==null?void 0:i.Make)||"Unknown",Model:(i==null?void 0:i.Model)||"Unknown",LensModel:(i==null?void 0:i.LensModel)||"Unknown",FocalLength:(i==null?void 0:i.FocalLength)||0,FNumber:(i==null?void 0:i.FNumber)||0,ExposureTime:((e=i==null?void 0:i.ExposureTime)==null?void 0:e.toString())||"0",ISO:(i==null?void 0:i.ISO)||0,DateTimeOriginal:(i==null?void 0:i.DateTimeOriginal)||"Unknown"}}}catch(t){throw console.error(":",t),t}},gs=({isOpen:n,files:e,onClose:t,onConfirm:r,onCancel:i,isConverting:o})=>{const{darkMode:a}=Oe(),[l,d]=p.useState("image/jpeg"),[g,h]=p.useState(.85);if(!n)return null;const x=k=>"HEIF/HEIC",v=k=>{switch(k){case"pending":return{label:"",color:a?"text-gray-400":"text-gray-500"};case"converting":return{label:"",color:"text-sky-500"};case"success":return{label:"",color:"text-green-500"};case"error":return{label:"",color:"text-red-500"};default:return{label:"",color:"text-gray-500"}}},F=()=>{if(!o)return"";const k=e.length,E=e.filter(S=>S.status==="success"||S.status==="error").length,P=e.filter(S=>S.status==="error").length;return E<k?` (${E}/${k})`:P>0?`${P} `:""};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:s.jsx("div",{className:`w-full max-w-lg rounded-xl shadow-2xl 
          ${a?"bg-gray-900 text-gray-100":"bg-white text-gray-800"}`,children:s.jsxs("div",{className:"p-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"HEIC/HEIF"}),s.jsx("p",{className:"text-sm mb-4",children:"HEIC/HEIFJPGPNGEXIF"}),s.jsxs("div",{className:"flex items-center gap-6 mb-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"mr-2",children:""}),s.jsxs("select",{value:l,onChange:k=>d(k.target.value),className:`border rounded px-2 py-1 ${a?"bg-gray-800 text-gray-100 border-gray-700":"bg-white border-gray-300"}`,children:[s.jsx("option",{value:"image/jpeg",children:"JPEG"}),s.jsx("option",{value:"image/png",children:"PNG"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"mr-2",children:"JPEG"}),s.jsx("input",{type:"range",min:.1,max:1,step:.01,value:g,onChange:k=>h(Number(k.target.value)),disabled:l!=="image/jpeg",className:"align-middle",style:{width:120}}),s.jsx("span",{className:"ml-2 text-xs",children:g.toFixed(2)})]})]}),s.jsx("div",{className:`mt-4 mb-6 rounded-lg overflow-hidden border 
            ${a?"border-gray-700 bg-gray-800":"border-gray-200 bg-gray-50"}`,children:s.jsx("div",{className:"max-h-64 overflow-y-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:`text-xs ${a?"bg-gray-800":"bg-gray-100"}`,children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left",children:""}),s.jsx("th",{className:"px-4 py-2 text-left",children:""}),s.jsx("th",{className:"px-4 py-2 text-right",children:""})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:e.map((k,E)=>{const P=v(k.status);return s.jsxs("tr",{className:a?"hover:bg-gray-700":"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3 text-sm truncate max-w-[180px]",children:k.file.name}),s.jsx("td",{className:"px-4 py-3 text-sm",children:x(k.type)}),s.jsxs("td",{className:"px-4 py-3 text-sm text-right",children:[s.jsx("span",{className:P.color,children:P.label}),k.status==="converting"&&k.progress!==void 0&&s.jsx("div",{className:"w-full mt-1 bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:s.jsx("div",{className:"bg-sky-500 h-1.5 rounded-full",style:{width:`${k.progress}%`}})}),k.status==="error"&&k.error&&s.jsx("div",{className:"text-xs text-red-500 mt-1",children:k.error})]})]},E)})})]})})}),o&&s.jsxs("div",{className:"mb-6",children:[s.jsx("p",{className:"text-sm font-medium mb-2",children:F()}),s.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:s.jsx("div",{className:"bg-sky-500 h-2 rounded-full transition-all duration-300",style:{width:`${e.filter(k=>k.status==="success"||k.status==="error").length/e.length*100}%`}})})]}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[!o&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:i,className:`px-4 py-2 rounded text-sm font-medium
                    ${a?"bg-gray-800 text-gray-300 hover:bg-gray-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:""}),s.jsx("button",{onClick:()=>r(l,g),className:"px-4 py-2 bg-sky-500 text-white rounded text-sm font-medium hover:bg-sky-600",children:""})]}),o&&s.jsx("button",{onClick:t,disabled:e.some(k=>k.status==="converting"),className:`px-4 py-2 rounded text-sm font-medium
                  ${e.some(k=>k.status==="converting")?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-sky-500 text-white hover:bg-sky-600"}`,children:e.every(k=>k.status==="success"||k.status==="error")?"":""})]})]})})})},ps=async(n,e="image/jpeg",t=.85,r)=>{try{r&&r(10);const i=await fs(n,e,t,r);return r&&r(100),i}catch(i){return console.error("HEIF:",i),null}},ms=async n=>{try{if(await ds(n))return{needsConversion:!0,type:"heif"}}catch(e){console.warn("HEIF:",e);const t=n.name.toLowerCase();if(t.endsWith(".heic")||t.endsWith(".heif"))return{needsConversion:!0,type:"heif"}}return{needsConversion:!1}},fn=n=>{const e=typeof n=="string"?parseFloat(n):n;if(e===0||isNaN(e))return"0s";if(e===1)return"1s";if(e>=1)return`${e}s`;const r=[2,4,8,15,30,60,125,250,500,1e3,2e3,4e3,8e3].find(k=>Math.abs(1/k-e)<1e-4);if(r)return`1/${r}s`;const i=e.toFixed(6),[o,a]=i.split("."),l=a.replace(/0+$/,""),d=Math.pow(10,l.length),g=parseInt(l),h=(k,E)=>E?h(E,k%E):k,x=h(g,d),v=g/x,F=d/x;return`${v}/${F}s`},xs=/\.(jpg|jpeg|png|gif|webp|bmp)$/i,ys=/\.(heic|heif)$/i,bs=()=>{const{darkMode:n,demoMode:e}=Oe(),{addImages:t,clearImages:r,removeImage:i,images:o,addImage:a}=ht(),[l,d]=p.useState(!1),[g,h]=p.useState(!1),[x,v]=p.useState([]),[F,k]=p.useState([]),[E,P]=p.useState(!1),[S,w]=p.useState(!0),[u,se]=p.useState("image/jpeg"),[ee,ce]=p.useState(.85);p.useEffect(()=>{},[]);const M=p.useCallback(async(y,z=!0)=>{if(y.length){z&&o.length>0&&r(),d(!0);try{const ge=await Promise.all(y.map(hn));t(ge)}catch(ge){console.error(":",ge),alert("")}finally{d(!1)}}},[t,r,o.length]),A=p.useCallback(async(y,z=!0)=>{if(!y.length)return;const ge=[],re=[];for(const le of Array.from(y)){const H=le.name.toLowerCase();if(xs.test(H))re.push(le);else if(ys.test(H))try{const{needsConversion:he,type:pe}=await ms(le);he&&pe?ge.push({file:le,type:pe,status:"pending"}):re.push(le)}catch(he){console.warn(`: ${le.name}`,he)}}ge.length>0?(v(ge),k(re),w(z),se("image/jpeg"),ce(.85),h(!0)):re.length>0&&M(re,z)},[M]),U=p.useCallback(async()=>{if(x.length===0)return;P(!0);const y=[],z=(re,le)=>{v(H=>H.map((he,pe)=>pe===re?{...he,...le}:he))};for(let re=0;re<x.length;re++){const le=x[re];try{if(z(re,{status:"converting",progress:0}),le.type==="heif"){const H=await ps(le.file,u,ee,he=>{z(re,{progress:he})});if(H){const he=u==="image/png"?".png":".jpg",pe=new File([H],le.file.name.replace(/\.(heic|heif)$/i,he),{type:u});y.push(pe),z(re,{status:"success"})}else z(re,{status:"error",error:""})}}catch(H){console.error(":",H),z(re,{status:"error",error:H instanceof Error?H.message:""})}}const ge=[...y,...F];ge.length>0&&await M(ge,S)},[x,F,S,M,u,ee]),j=p.useCallback(()=>{F.length>0&&M(F,S),h(!1),v([]),k([])},[F,S,M]),G=p.useCallback(()=>{h(!1),v([]),k([]),P(!1)},[]),J=p.useCallback(y=>{y.preventDefault();const z=y.dataTransfer.files;z&&z.length>0&&A(z)},[A]),_=p.useCallback(y=>{y.preventDefault()},[]),X=p.useCallback(()=>{const y=document.createElement("input");y.type="file",y.accept="image/*,.heic,.heif",y.multiple=!0,y.onchange=z=>{z.target instanceof HTMLInputElement&&z.target.files&&A(z.target.files)},y.click()},[A]),$=()=>s.jsxs("div",{className:"w-full",children:[!e&&s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("button",{onClick:()=>{const y=document.createElement("input");y.type="file",y.accept="image/*,.heic,.heif",y.multiple=!0,y.onchange=z=>{z.target instanceof HTMLInputElement&&z.target.files&&A(z.target.files,!0)},y.click()},className:`px-4 py-2 rounded-lg font-medium transition-all duration-200
              ${n?"bg-sky-500/20 text-gray-100 hover:bg-sky-500/30":"bg-sky-500/10 text-gray-700 hover:bg-sky-500/20"}`,children:""}),s.jsx("button",{onClick:()=>{const y=document.createElement("input");y.type="file",y.accept="image/*,.heic,.heif",y.multiple=!0,y.onchange=z=>{z.target instanceof HTMLInputElement&&z.target.files&&A(z.target.files,!1)},y.click()},className:`p-2 rounded-lg font-medium transition-all duration-200
              ${n?"bg-sky-500/20 text-gray-100 hover:bg-sky-500/30":"bg-sky-500/10 text-gray-700 hover:bg-sky-500/20"}`,title:"",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),s.jsx("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 ${e?"p-0":""}`,children:o.map(y=>s.jsxs("div",{className:`relative group aspect-[3/2] ${n?"bg-black":"bg-gray-100"} rounded-lg overflow-hidden`,children:[s.jsx("img",{src:y.url,alt:y.name,className:"w-full h-full object-contain"}),!e&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-200"}),s.jsx("button",{onClick:()=>i(y.id),className:`absolute top-2 right-2 p-1.5 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200
                    ${n?"bg-gray-900/80 text-gray-100 hover:bg-gray-900":"bg-white/80 text-gray-700 hover:bg-white"}`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),y.exif&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-3 text-sm text-white bg-gradient-to-t from-black/70 to-transparent",children:s.jsxs("div",{className:"space-y-1",children:[y.exif.Make!=="Unknown"&&y.exif.Model!=="Unknown"&&s.jsxs("p",{children:[y.exif.Make," ",y.exif.Model]}),y.exif.LensModel!=="Unknown"&&s.jsx("p",{children:y.exif.LensModel}),y.exif.FocalLength>0&&s.jsxs("p",{children:[y.exif.FocalLength,"mm"]}),y.exif.FNumber>0&&s.jsxs("p",{children:["f/",y.exif.FNumber]}),y.exif.ISO>0&&s.jsx("p",{children:y.exif.ISO}),y.exif.ExposureTime!=="0"&&s.jsx("p",{children:fn(y.exif.ExposureTime)})]})})]})]},y.id))})]});return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`flex flex-col items-center justify-center min-h-screen ${n?"bg-black":"bg-gray-100"} ${e?"demo-mode":"pt-12"}`,children:s.jsx("div",{className:`w-full max-w-4xl ${e?"p-0 demo-content":"p-4 -mt-48"}`,children:e?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(y=>s.jsxs("div",{className:`relative aspect-[3/2] ${n?"bg-black":"bg-gray-100"} rounded-lg overflow-hidden`,children:[s.jsx("img",{src:y.url,alt:y.name,className:"w-full h-full object-contain"}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-3 text-sm text-white bg-gradient-to-t from-black/70 to-transparent",children:s.jsxs("div",{className:"space-y-1",children:[y.exif.Make!=="Unknown"&&y.exif.Model!=="Unknown"&&s.jsxs("p",{children:[y.exif.Make," ",y.exif.Model]}),y.exif.LensModel!=="Unknown"&&s.jsx("p",{children:y.exif.LensModel}),y.exif.FocalLength>0&&s.jsxs("p",{children:[y.exif.FocalLength,"mm"]}),y.exif.FNumber>0&&s.jsxs("p",{children:["f/",y.exif.FNumber]}),y.exif.ISO>0&&s.jsx("p",{children:y.exif.ISO}),y.exif.ExposureTime!=="0"&&s.jsx("p",{children:fn(y.exif.ExposureTime)})]})})]},y.id))}):s.jsx(s.Fragment,{children:l?s.jsx("div",{className:"text-center",children:s.jsx("p",{className:n?"text-gray-300":"text-gray-600",children:"..."})}):o.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center",children:[s.jsxs("div",{className:`flex flex-col items-center justify-center w-[480px] h-[320px] border-4 border-dashed rounded-2xl p-8 cursor-pointer
                    ${n?"border-gray-800 text-gray-300 bg-black":"border-gray-300 text-gray-600"}
                    transition-all duration-200 
                    ${n?"hover:border-sky-500/50 hover:bg-sky-500/10":"hover:border-sky-500/50 hover:bg-sky-500/5"}`,onClick:X,onDrop:J,onDragOver:_,children:[s.jsx("svg",{className:`mx-auto h-12 w-12 ${n?"text-gray-600":"text-gray-500"}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})}),s.jsx("h3",{className:"mt-4 text-base font-medium",children:""}),s.jsx("p",{className:"mt-2 text-sm text-gray-500",children:""}),s.jsx("p",{className:`mt-1 text-xs ${n?"text-gray-600":"text-gray-400"}`,children:"JPGPNGGIFWebPHEIC"})]}),s.jsxs("div",{className:"mt-4 flex items-center text-xs text-gray-500",children:[s.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),s.jsx("span",{children:""})]})]}):$()})})}),s.jsx(gs,{isOpen:g,files:x,onClose:G,onConfirm:(y,z)=>{se(y),ce(z),setTimeout(()=>U(),0)},onCancel:j,isConverting:E})]})},gr=({imageInfo:n})=>{const{darkMode:e,exifSettings:t}=Oe(),[r,i]=p.useState("");p.useEffect(()=>{const h=new Image;h.onload=()=>{i(`${h.naturalWidth}  ${h.naturalHeight}`)},h.src=n.url},[n.url]);const o=Object.entries({...n.exif,Resolution:r}).filter(([h,x])=>t[h]&&x!==void 0&&x!==null&&x!==""&&x!=="Unknown"&&x!=="NaN"&&x!=="Invalid Date"&&!(typeof x=="number"&&(isNaN(x)||x===0))&&!(typeof x=="string"&&(x==="0"||x.trim()==="0"||x.trim()==="0s")));if(o.length===0)return null;const a=(h,x)=>{switch(h){case"FocalLength":return`${x}mm`;case"FNumber":return`f/${x}`;case"ExposureTime":return fn(x);case"DateTimeOriginal":return new Date(x).toLocaleString();case"ISO":return x.toString();case"Resolution":case"FileName":case"Make":case"Model":case"LensModel":return String(x);default:return String(x)}},l=o.reduce((h,[x,v])=>x==="Make"||x==="Model"?(h.camera||(h.camera=[]),h.camera.push(String(v)),h):{...h,[x]:v},{}),d={},g={};return Object.entries(l).forEach(([h,x])=>{h==="camera"||h==="FocalLength"||h==="FNumber"||h==="ExposureTime"||h==="ISO"?d[h]=x:g[h]=x}),s.jsxs("div",{className:"absolute bottom-9 left-0 right-0 flex flex-col items-center space-y-2 pointer-events-none z-10",children:[Object.keys(d).length>0&&s.jsx("div",{className:`max-w-[95%] md:max-w-[85%] overflow-x-auto rounded-full px-5 py-2 backdrop-blur-md text-sm
          ${e?"bg-black/60 text-gray-100 shadow-lg shadow-black/30":"bg-white/70 text-gray-700 shadow-lg shadow-black/10"} 
          transition-all duration-300 scrollbar-hide pointer-events-auto select-none`,children:s.jsx("div",{className:"flex items-center space-x-2 flex-nowrap",children:Object.entries(d).map(([h,x])=>h==="camera"&&Array.isArray(x)?s.jsx("div",{className:"font-medium whitespace-nowrap",children:x.join(" ")},"camera"):s.jsxs("div",{className:"font-medium whitespace-nowrap flex items-center",children:[h!=="camera"&&s.jsx("span",{className:"mx-2 h-1 w-1 rounded-full bg-current opacity-40 flex-shrink-0"}),String(a(h,x))]},h))})}),Object.keys(g).length>0&&s.jsx("div",{className:`max-w-[80%] md:max-w-[60%] px-4 py-1.5 text-xs select-none
            ${e?"text-gray-300/80":"text-gray-600/80"} 
            transition-all duration-300 pointer-events-auto`,children:s.jsx("div",{className:"flex items-center justify-center flex-wrap gap-x-3 gap-y-1",children:Object.entries(g).map(([h,x])=>s.jsx("div",{className:"flex items-center whitespace-nowrap",children:a(h,x)},h))})})]})},Se=zt((n,e)=>({isAnnotateMode:!1,setAnnotateMode:t=>n({isAnnotateMode:t}),annotationToolbar:{visible:!1,position:{x:100,y:100}},setToolbarVisible:t=>n(r=>({annotationToolbar:{...r.annotationToolbar,visible:t}})),setToolbarPosition:t=>n(r=>({annotationToolbar:{...r.annotationToolbar,position:t}})),annotationTool:"rect",setAnnotationTool:t=>n({annotationTool:t}),annotationStrokeWidth:2,setStrokeWidth:t=>n({annotationStrokeWidth:t}),annotationColor:"#FF0000",setAnnotationColor:t=>n({annotationColor:t}),annotationFontSize:18,setAnnotationFontSize:t=>n({annotationFontSize:t}),annotations:{},addAnnotation:(t,r)=>n(i=>({annotations:{...i.annotations,[t]:[...i.annotations[t]||[],r]}})),setAnnotations:(t,r)=>n(i=>({annotations:{...i.annotations,[t]:r}})),clearAnnotations:t=>n(r=>({annotations:{...r.annotations,[t]:[]}})),selectedAnnotationId:{},setSelectedAnnotationId:(t,r)=>n(i=>({selectedAnnotationId:{...i.selectedAnnotationId,[t]:r}})),moveAnnotation:(t,r,i,o)=>n(a=>{const l=a.annotations[t]||[],d=l.findIndex(v=>v.id===r);if(d===-1)return{};const g=l[d];let h=g.points;g.type==="rect"||g.type==="ellipse"?h=[g.points[0]+i,g.points[1]+o,g.points[2]+i,g.points[3]+o]:g.type==="pen"?h=g.points.map((v,F)=>F%2===0?v+i:v+o):g.type==="text"&&(h=[g.points[0]+i,g.points[1]+o]);const x=[...l];return x[d]={...g,points:h},{annotations:{...a.annotations,[t]:x}}}),deleteAnnotation:(t,r)=>n(i=>{const o=i.annotations[t]||[];if(o.findIndex(d=>d.id===r)===-1)return{};e().pushUndo(t,o);const l=o.filter(d=>d.id!==r);return{annotations:{...i.annotations,[t]:l},selectedAnnotationId:{...i.selectedAnnotationId,[t]:null}}}),undoStack:{},redoStack:{},pushUndo:(t,r)=>n(i=>({undoStack:{...i.undoStack,[t]:[...i.undoStack[t]||[],JSON.parse(JSON.stringify(r))]},redoStack:{...i.redoStack,[t]:[]}})),undo:t=>n(r=>{const i=r.undoStack[t]||[];if(i.length===0)return{};const o=r.redoStack[t]||[],a=i[i.length-1];return{annotations:{...r.annotations,[t]:a},undoStack:{...r.undoStack,[t]:i.slice(0,-1)},redoStack:{...r.redoStack,[t]:[...o,r.annotations[t]||[]]}}}),redo:t=>n(r=>{const i=r.redoStack[t]||[];if(i.length===0)return{};const o=r.undoStack[t]||[],a=i[i.length-1];return{annotations:{...r.annotations,[t]:a},redoStack:{...r.redoStack,[t]:i.slice(0,-1)},undoStack:{...r.undoStack,[t]:[...o,r.annotations[t]||[]]}}}),drawing:null,setDrawing:t=>n({drawing:t}),editingTextId:null,setEditingTextId:t=>n({editingTextId:t})})),pr=[{scale:1,offsetX:0,offsetY:0},{scale:1,offsetX:0,offsetY:0},{scale:1,offsetX:0,offsetY:0},{scale:1,offsetX:0,offsetY:0},{scale:1,offsetX:0,offsetY:0}],In=zt(n=>({enabled:!1,keyframes:pr,currentIdx:0,playing:!1,frameDuration:3e3,transitionDuration:2e3,transitionEasing:"ease-in-out",setEnabled:e=>n({enabled:e}),setKeyframe:(e,t)=>n(r=>{const i=[...r.keyframes];return i[e]=t,{keyframes:i}}),setCurrentIdx:e=>n({currentIdx:e}),setPlaying:e=>n({playing:e}),setFrameDuration:e=>n({frameDuration:e}),setTransitionDuration:e=>n({transitionDuration:e}),setTransitionEasing:e=>n({transitionEasing:e}),reset:()=>n({keyframes:pr,currentIdx:0,playing:!1})})),vs=({images:n=[]})=>{var Rn,Un,Bn,$n,zn,Hn,Wn,_n,Vn;const{darkMode:e,syncZoom:t,demoMode:r,showZoomControls:i}=Oe(),{removeImage:o,addImages:a}=ht(),{isAnnotateMode:l,annotationTool:d,annotationColor:g,annotationStrokeWidth:h,annotationFontSize:x,annotations:v,addAnnotation:F,setAnnotations:k,undo:E,redo:P,selectedAnnotationId:S,setSelectedAnnotationId:w,drawing:u,setDrawing:se,editingTextId:ee,setEditingTextId:ce,deleteAnnotation:M}=Se(),A=p.useRef([]),U=p.useRef([]),[j,G]=p.useState([]),[J,_]=p.useState(!1),[X,$]=p.useState(null),[y,z]=p.useState({width:0,height:0}),[ge,re]=p.useState(null),[le,H]=p.useState(null),[he,pe]=p.useState(!1),[Ee,R]=p.useState(null),[q,oe]=p.useState(""),[ie,f]=p.useState(null),C=p.useRef(null),Ce=p.useRef(j);p.useEffect(()=>{Ce.current=j},[j]);const Z=p.useRef(t);p.useEffect(()=>{Z.current=t},[t]),p.useEffect(()=>{var c;if(n.length===1){const I=(((c=n[0].exif)==null?void 0:c.Resolution)||"").match(/(\d+)\s*[x]\s*(\d+)/);if(I){const N=parseInt(I[1],10),O=parseInt(I[2],10);z({width:N,height:O}),re([0,0,N,O])}}},[n]),p.useEffect(()=>{G(Array(n.length).fill({scale:1,x:0,y:0}))},[n.length]);const de=p.useRef({isDragging:!1,currentIndex:-1,startX:0,startY:0});p.useEffect(()=>{A.current=A.current.slice(0,n.length),U.current=U.current.slice(0,n.length)},[n.length]);const Ne=(c,m)=>{G(I=>{if(Z.current){const N=m(I[c]||{scale:1,x:0,y:0});return I.map(()=>({...N}))}else{const N=[...I];return N[c]=m(I[c]||{scale:1,x:0,y:0}),N}})};p.useEffect(()=>{const c=A.current,m=[],I=[];c.forEach((V,W)=>{if(!V)return;const te=T=>{T.preventDefault(),Ne(W,D=>{const B=T.deltaY*-.01,L=Math.max(.1,Math.min(10,D.scale+B));return{...D,scale:L}})},b=T=>{if(T.target.tagName!=="IMG"||l)return;const D=Ce.current[W]||{x:0,y:0};de.current={isDragging:!0,currentIndex:W,startX:T.clientX-D.x,startY:T.clientY-D.y},window.addEventListener("mousemove",N),window.addEventListener("mouseup",O),T.preventDefault()};V.addEventListener("wheel",te,{passive:!1}),V.addEventListener("mousedown",b),m[W]=te,I[W]=b});function N(V){if(!de.current.isDragging)return;const{currentIndex:W,startX:te,startY:b}=de.current;Ne(W,T=>({...T,x:V.clientX-te,y:V.clientY-b}))}function O(){de.current.isDragging=!1,window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",O)}return()=>{c.forEach((V,W)=>{V&&(m[W]&&V.removeEventListener("wheel",m[W]),I[W]&&V.removeEventListener("mousedown",I[W]))}),window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",O)}},[l,n.length]);const ze=c=>{const m=c.currentTarget;if(typeof m.createSVGPoint!="function")return[c.nativeEvent.offsetX,c.nativeEvent.offsetY];const I=m.createSVGPoint();I.x=c.clientX,I.y=c.clientY;const N=m.getScreenCTM();if(!N)return[0,0];const O=I.matrixTransform(N.inverse());return[O.x,O.y]};p.useEffect(()=>{if(!ee)return;let c=!0;const m=I=>{const N=document.querySelector(".text-popover");setTimeout(()=>{if(c){c=!1;return}N&&!N.contains(I.target)&&(console.log("[window mousedown] "),ce==null||ce(null),H(null))},0)};return window.addEventListener("mousedown",m),()=>window.removeEventListener("mousedown",m)},[ee]);const En=(c,m)=>{var O;if(!l||X||u&&u.imageId!==n[m].id)return;const[I,N]=ze(c);if(d==="move"){const V=v[n[m].id]||[];let W=!1;for(let te=V.length-1;te>=0;te--){const b=V[te];if(b.type==="rect"||b.type==="ellipse"){const[T,D,B,L]=b.points;if(I>=Math.min(T,B)&&I<=Math.max(T,B)&&N>=Math.min(D,L)&&N<=Math.max(D,L)){w(n[m].id,b.id),W=!0;break}}else if(b.type==="pen"){for(let T=0;T<b.points.length;T+=2)if(Math.abs(b.points[T]-I)<8&&Math.abs(b.points[T+1]-N)<8){w(n[m].id,b.id),W=!0;break}}else if(b.type==="text"){const[T,D]=b.points;if(Math.abs(T-I)<40&&Math.abs(D-N)<24){w(n[m].id,b.id),W=!0;break}}}W||w(n[m].id,null);return}if(d==="text"){const W=c.currentTarget.getBoundingClientRect(),te=((O=j[m])==null?void 0:O.scale)||1,b=(c.clientX-W.left)/te,T=(c.clientY-W.top)/te;pe(!0),R({left:c.clientX,top:c.clientY}),f([b,T]),oe("");return}se(d==="pen"?{type:"pen",start:[I,N],points:[I,N],imageId:n[m].id}:{type:d,start:[I,N],points:[I,N,I,N],imageId:n[m].id})},Y=8,He=4,Ie=9,Me=4,We=({cx:c,cy:m,onPointerUp:I})=>{const[N,O]=p.useState(!1);return s.jsxs("g",{style:{cursor:"pointer"},onPointerDown:V=>{V.stopPropagation()},onPointerUp:I,onMouseEnter:()=>O(!0),onMouseLeave:()=>O(!1),children:[s.jsx("circle",{cx:c,cy:m,r:Ie,fill:N?"#007AFF":"#fff",stroke:"#007AFF",strokeWidth:1.5}),s.jsx("path",{d:`M${c-3},${m-3} L${c+3},${m+3} M${c-3},${m+3} L${c+3},${m-3}`,stroke:N?"#fff":"#007AFF",strokeWidth:1.5,strokeLinecap:"round"})]})},[_e,Ve]=p.useState(null),Nn=(c,m)=>{var O;if(!l)return;if(_e){const V=c.clientX-_e.x,W=c.clientY-_e.y;(Math.abs(V)>2||Math.abs(W)>2)&&($({imgIdx:_e.imgIdx,annId:_e.annId,start:[_e.x,_e.y],last:[c.clientX,c.clientY]}),Ve(null));return}if(X){const[V,W]=[c.clientX,c.clientY],te=V-X.last[0],b=W-X.last[1],T=((O=j[m])==null?void 0:O.scale)||1,D=te/T,B=b/T;(Math.abs(D)>.01||Math.abs(B)>.01)&&(Z.current?n.forEach(L=>{S[L.id]&&Se.getState().moveAnnotation(L.id,S[L.id],D,B)}):Se.getState().moveAnnotation(n[m].id,X.annId,D,B),$({...X,last:[V,W]}));return}if(!u||u.imageId!==n[m].id)return;const[I,N]=ze(c);u&&u.type==="pen"?se({...u,points:[...u.points,I,N]}):u&&se({...u,points:[u.start[0],u.start[1],I,N]})},Mn=(c,m)=>{if(!l)return;if(_e){Ve(null);return}if(X){$(null);return}if(!u||u.imageId!==n[m].id)return;const I={id:`${Date.now()}-${Math.random().toString(36).slice(2)}`,type:u.type,points:u.points,color:g,strokeWidth:h};Z.current?n.forEach(N=>F(N.id,I)):F(n[m].id,I),se(null)};p.useEffect(()=>{if(!l)return;const c=m=>{(m.ctrlKey||m.metaKey)&&m.key.toLowerCase()==="z"&&n.length>0&&E(n[0].id),(m.ctrlKey||m.metaKey)&&m.key.toLowerCase()==="y"&&n.length>0&&P(n[0].id),(m.key==="Delete"||m.key==="Backspace")&&(Z.current?n.forEach(I=>{const N=S[I.id];N&&Se.getState().deleteAnnotation(I.id,N)}):n.forEach(I=>{const N=S[I.id];N&&Se.getState().deleteAnnotation(I.id,N)}))};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[l,n,E,P,S,Z]),p.useEffect(()=>{n.length===0&&ht.setState({hasViewedImages:!1})},[n.length]);const An=()=>{if(q.trim()&&ie){const c={id:`${Date.now()}-${Math.random().toString(36).slice(2)}`,type:"text",points:ie,color:g,strokeWidth:h,text:q,fontSize:x};Z.current?n.forEach(m=>F(m.id,c)):F(n[0].id,c)}pe(!1),R(null),oe(""),f(null)},qr=he&&Ee?bt.createPortal(s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"text-popover-mask",style:{position:"fixed",inset:0,zIndex:9998,background:"transparent"},onClick:An}),s.jsx("textarea",{ref:C,value:q,onChange:c=>{oe(c.target.value),C.current&&(C.current.style.width="2px",C.current.style.width=`${Math.max(180,C.current.scrollWidth)}px`)},onKeyDown:c=>{c.key==="Enter"&&!c.shiftKey?(c.preventDefault(),An()):c.key==="Escape"&&(c.preventDefault(),pe(!1),R(null),oe(""),f(null))},placeholder:"...",style:{position:"fixed",left:Ee.left,top:Ee.top,width:"180px",minWidth:"2px",height:x+4,padding:"0 2px",margin:0,border:"none",outline:"none",background:"transparent",color:g,caretColor:g,fontSize:x,fontFamily:"system-ui, -apple-system, sans-serif",resize:"none",overflow:"hidden",whiteSpace:"nowrap",zIndex:9999,lineHeight:"1",verticalAlign:"middle",transform:"translate(-2px, -50%)",boxSizing:"border-box"}})]}),document.body):null;p.useEffect(()=>{he&&C.current&&requestAnimationFrame(()=>{if(C.current){C.current.focus();const c=C.current.value.length;C.current.setSelectionRange(c,c)}})},[he]);const[Zr,Jt]=p.useState([]),pt=[1,2,5];p.useEffect(()=>{Jt(Array(n.length).fill(-1))},[n.length]);const Tn=(c,m)=>{Jt(I=>{const N=[...I];return N[c]===m?N[c]=-1:N[c]=m,N}),G(I=>{const N=[...I];if(Zr[c]===m){if(Z.current)return N.map(()=>({scale:1,x:0,y:0}));N[c]={...N[c],scale:1}}else{if(Z.current)return N.map(()=>({scale:pt[m],x:0,y:0}));N[c]={...N[c],scale:pt[m]}}return N})};p.useEffect(()=>{Jt(c=>c.map((m,I)=>{var O;if(m===-1)return-1;const N=((O=j[I])==null?void 0:O.scale)||1;return Math.abs(N-pt[m])>.01?-1:m}))},[j]);const{enabled:Te,keyframes:Fn,currentIdx:Ue,setKeyframe:Dn,setCurrentIdx:Ln,playing:jt,setPlaying:On,frameDuration:qt,transitionDuration:It,transitionEasing:lt}=In();return p.useEffect(()=>{var I,N,O;if(!Te||n.length!==1)return;const c=0,m={scale:((I=j[c])==null?void 0:I.scale)||1,offsetX:((N=j[c])==null?void 0:N.x)||0,offsetY:((O=j[c])==null?void 0:O.y)||0};Dn(Ue,m)},[(Rn=j[0])==null?void 0:Rn.scale,(Un=j[0])==null?void 0:Un.x,(Bn=j[0])==null?void 0:Bn.y,Te,Ue,n.length]),ne.useEffect(()=>{var T,D,B;if(!Te||n.length!==1)return;const c=0,m=Fn[Ue];if(!m)return;let I,N=0;const O=It||400,V={scale:((T=j[c])==null?void 0:T.scale)||1,x:((D=j[c])==null?void 0:D.x)||0,y:((B=j[c])==null?void 0:B.y)||0},W={scale:m.scale,x:m.offsetX,y:m.offsetY},te=L=>lt==="linear"?L:lt==="ease-in"?L*L:L<.5?2*L*L:-1+(4-2*L)*L,b=()=>{N+=16;const L=Math.min(N/O,1),Q=te(L),xe=V.scale+(W.scale-V.scale)*Q,we=V.x+(W.x-V.x)*Q,ue=V.y+(W.y-V.y)*Q;G(ae=>{const ke=[...ae];return ke[c]={scale:xe,x:we,y:ue},ke}),L<1&&(I=requestAnimationFrame(b))};return b(),()=>cancelAnimationFrame(I)},[Ue,Te,n.length,It,lt]),p.useEffect(()=>{!Te||n.length<=1||n.forEach((c,m)=>{var N,O,V;const I={scale:((N=j[m])==null?void 0:N.scale)||1,offsetX:((O=j[m])==null?void 0:O.x)||0,offsetY:((V=j[m])==null?void 0:V.y)||0};Dn(Ue,I)})},[j,Te,Ue,n.length]),ne.useEffect(()=>{!Te||n.length<=1||n.forEach((c,m)=>{var D,B,L;const I=Fn[Ue];if(!I)return;let N,O=0;const V=It||400,W={scale:((D=j[m])==null?void 0:D.scale)||1,x:((B=j[m])==null?void 0:B.x)||0,y:((L=j[m])==null?void 0:L.y)||0},te={scale:I.scale,x:I.offsetX,y:I.offsetY},b=Q=>lt==="linear"?Q:lt==="ease-in"?Q*Q:Q<.5?2*Q*Q:-1+(4-2*Q)*Q,T=()=>{O+=16;const Q=Math.min(O/V,1),xe=b(Q),we=W.scale+(te.scale-W.scale)*xe,ue=W.x+(te.x-W.x)*xe,ae=W.y+(te.y-W.y)*xe;G(ke=>{const fe=[...ke];return fe[m]={scale:we,x:ue,y:ae},fe}),Q<1&&(N=requestAnimationFrame(T))};return T(),()=>cancelAnimationFrame(N)})},[Ue,Te,n.length,It,lt]),p.useEffect(()=>{if(!Te||!jt)return;let c=Ue,m;const I=()=>{c=(c+1)%5,Ln(c),c!==4?m=setTimeout(I,qt||1200):On(!1)};return m=setTimeout(I,qt||1200),()=>clearTimeout(m)},[jt,Te,qt]),ne.useEffect(()=>{if(!Te)return;const c=m=>{if(!(m.target&&m.target.tagName==="INPUT")){if(m.code.startsWith("Digit")){const I=Number(m.code.replace("Digit",""));I>=1&&I<=5&&Ln(I-1)}m.code==="Space"&&(On(!jt),m.preventDefault())}};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[Te,jt]),n.length===0?null:s.jsxs("div",{className:"fixed inset-0 flex items-center justify-center",children:[n.length===1?s.jsx("div",{className:"w-full md:w-[90%] h-[80vh] px-4 flex items-center justify-center",children:s.jsx("div",{className:"relative w-full h-full flex items-center justify-center",children:s.jsxs("div",{ref:c=>A.current[0]=c,className:`w-full h-full ${e?"bg-black":"bg-white"} rounded-lg shadow-lg overflow-hidden relative group`,children:[i&&s.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 bottom-36 z-30 flex flex-row items-end space-x-3 select-none mb-4",children:pt.map((c,m)=>{var V;const I=((V=j[0])==null?void 0:V.scale)||1;let N=!1;m===0&&I>=1&&I<2&&(N=!0),m===1&&I>=2&&I<5&&(N=!0),m===2&&I>=5&&(N=!0);const O=Number.isInteger(I)?`${I}x`:`${I.toFixed(1)}x`;return s.jsx("button",{onClick:()=>Tn(0,m),className:`w-9 h-9 flex items-center justify-center rounded-full font-semibold transition-all duration-200 shadow-md
                          border border-gray-300 dark:border-gray-700
                          bg-white/80 dark:bg-gray-900/80 backdrop-blur-md
                          hover:bg-sky-100/80 dark:hover:bg-gray-800/90
                          focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-50
                        `,style:{minWidth:36,minHeight:36,maxWidth:36,maxHeight:36,outline:"none",position:"relative",transform:N?"scale(1.22)":"scale(1)"},title:`${c}x`,children:N?s.jsx("span",{className:"text-gray-700 dark:text-gray-100 font-medium whitespace-nowrap text-[13px] leading-none drop-shadow-sm",children:O}):s.jsxs("span",{className:"text-gray-700 dark:text-gray-200 font-medium whitespace-nowrap text-[13px] leading-none drop-shadow-sm",children:[c,"x"]})},c)})}),s.jsx("img",{ref:c=>U.current[0]=c,src:n[0].url,alt:n[0].exif.FileName,className:"w-full h-full object-contain select-none",style:{transform:`translate(${(($n=j[0])==null?void 0:$n.x)||0}px, ${((zn=j[0])==null?void 0:zn.y)||0}px) scale(${((Hn=j[0])==null?void 0:Hn.scale)||1})`,touchAction:"none",userSelect:"none",WebkitUserSelect:"none"},draggable:!1}),s.jsxs("svg",{className:"absolute inset-0 w-full h-full z-20",style:{transform:`translate(${((Wn=j[0])==null?void 0:Wn.x)||0}px, ${((_n=j[0])==null?void 0:_n.y)||0}px) scale(${((Vn=j[0])==null?void 0:Vn.scale)||1})`,pointerEvents:l?he?"none":"auto":"none",touchAction:"none",userSelect:"none",WebkitUserSelect:"none"},onPointerDown:l?c=>En(c,0):void 0,onPointerMove:l?c=>Nn(c,0):void 0,onPointerUp:l?c=>Mn(c,0):void 0,children:[(v[n[0].id]||[]).map((c,m)=>{var N;const I=S[n[0].id]===c.id;if(c.type==="rect"){const[O,V,W,te]=c.points,b=Math.min(O,W),T=Math.min(V,te),D=Math.abs(W-O),B=Math.abs(te-V);return s.jsxs("g",{children:[s.jsx("rect",{x:b,y:T,width:D,height:B,stroke:c.color,strokeWidth:c.strokeWidth,vectorEffect:"non-scaling-stroke",fill:"none",onPointerDown:L=>{L.stopPropagation(),w(n[0].id,c.id),d==="move"&&(Z.current?n.forEach(Q=>Se.getState().pushUndo(Q.id,v[Q.id]||[])):Se.getState().pushUndo(n[0].id,v[n[0].id]||[])),Ve({x:L.clientX,y:L.clientY,annId:c.id,imgIdx:0})}}),d==="move"&&I&&s.jsxs("g",{children:[s.jsx("rect",{x:b-Y,y:T-Y,width:D+Y*2,height:B+Y*2,stroke:"#007AFF",strokeWidth:2,fill:"none",rx:He,strokeDasharray:"4 4",style:{filter:"drop-shadow(0 0 2px #007AFF88)"},pointerEvents:"all",onPointerDown:L=>{L.stopPropagation(),$({imgIdx:0,annId:c.id,start:[L.clientX,L.clientY],last:[L.clientX,L.clientY]})}}),s.jsx(We,{cx:b+D+Y+Ie+Me,cy:T-Y-Ie-Me,onPointerUp:L=>{L.stopPropagation(),Z.current?n.forEach(Q=>M(Q.id,c.id)):M(n[0].id,c.id)}})]})]},c.id)}if(c.type==="ellipse"){const[O,V,W,te]=c.points,b=Math.min(O,W),T=Math.min(V,te),D=Math.abs(W-O),B=Math.abs(te-V);return s.jsxs("g",{children:[s.jsx("ellipse",{cx:(O+W)/2,cy:(V+te)/2,rx:D/2,ry:B/2,stroke:c.color,strokeWidth:c.strokeWidth,vectorEffect:"non-scaling-stroke",fill:"none",onPointerDown:L=>{L.stopPropagation(),w(n[0].id,c.id),d==="move"&&(Z.current?n.forEach(Q=>Se.getState().pushUndo(Q.id,v[Q.id]||[])):Se.getState().pushUndo(n[0].id,v[n[0].id]||[])),Ve({x:L.clientX,y:L.clientY,annId:c.id,imgIdx:0})}}),d==="move"&&I&&s.jsxs("g",{children:[s.jsx("rect",{x:b-Y,y:T-Y,width:D+Y*2,height:B+Y*2,stroke:"#007AFF",strokeWidth:2,fill:"none",rx:He,strokeDasharray:"4 4",style:{filter:"drop-shadow(0 0 2px #007AFF88)"},pointerEvents:"all",onPointerDown:L=>{L.stopPropagation(),$({imgIdx:0,annId:c.id,start:[L.clientX,L.clientY],last:[L.clientX,L.clientY]})}}),s.jsx(We,{cx:b+D+Y+Ie+Me,cy:T-Y-Ie-Me,onPointerUp:L=>{L.stopPropagation(),Z.current?n.forEach(Q=>M(Q.id,c.id)):M(n[0].id,c.id)}})]})]},c.id)}if(c.type==="pen"){const O=c.points,V=O.length>=4?`M${O[0]},${O[1]} `+O.slice(2).map((D,B)=>B%2===0?`L${O[B+2]},${O[B+3]}`:"").join(" "):"";let W=1/0,te=1/0,b=-1/0,T=-1/0;for(let D=0;D<O.length;D+=2)W=Math.min(W,O[D]),te=Math.min(te,O[D+1]),b=Math.max(b,O[D]),T=Math.max(T,O[D+1]);return s.jsxs("g",{children:[s.jsx("path",{d:V,stroke:c.color,strokeWidth:c.strokeWidth,vectorEffect:"non-scaling-stroke",fill:"none",strokeLinejoin:"round",strokeLinecap:"round",onPointerDown:D=>{D.stopPropagation(),w(n[0].id,c.id),d==="move"&&(Z.current?n.forEach(B=>Se.getState().pushUndo(B.id,v[B.id]||[])):Se.getState().pushUndo(n[0].id,v[n[0].id]||[])),Ve({x:D.clientX,y:D.clientY,annId:c.id,imgIdx:0})}}),d==="move"&&I&&s.jsxs("g",{children:[s.jsx("rect",{x:W-Y,y:te-Y,width:b-W+Y*2,height:T-te+Y*2,stroke:"#007AFF",strokeWidth:2,fill:"none",rx:He,strokeDasharray:"4 4",style:{filter:"drop-shadow(0 0 2px #007AFF88)"},pointerEvents:"all",onPointerDown:D=>{D.stopPropagation(),$({imgIdx:0,annId:c.id,start:[D.clientX,D.clientY],last:[D.clientX,D.clientY]})}}),s.jsx(We,{cx:b+Y+Ie+Me,cy:te-Y-Ie-Me,onPointerUp:D=>{D.stopPropagation(),Z.current?n.forEach(B=>M(B.id,c.id)):M(n[0].id,c.id)}})]})]},c.id)}if(c.type==="text"){const[O,V]=c.points,W=(((N=c.text)==null?void 0:N.length)||0)*(c.fontSize||18)*.96,te=Math.max(120,W+16),b=40;return ee===c.id?null:s.jsxs("g",{children:[s.jsx("text",{x:O,y:V,fontSize:c.fontSize||18,fill:c.color,textAnchor:"start",alignmentBaseline:"middle",style:{cursor:d==="move"?"move":"text",userSelect:"none",...I?{filter:"drop-shadow(0 0 2px #007AFF88)"}:{}},onDoubleClick:()=>ce==null?void 0:ce(c.id),onPointerDown:T=>{T.stopPropagation(),d==="move"&&(w(n[0].id,c.id),$({imgIdx:0,annId:c.id,start:[T.clientX,T.clientY],last:[T.clientX,T.clientY]}))},children:c.text}),d==="move"&&I&&s.jsxs("g",{children:[s.jsx("rect",{x:O-Y,y:V-b/2-Y,width:te+Y*2,height:b+Y*2,stroke:"#007AFF",strokeWidth:2,fill:"none",rx:He,strokeDasharray:"4 4",style:{filter:"drop-shadow(0 0 2px #007AFF88)"},pointerEvents:"all",onPointerDown:T=>{T.stopPropagation(),$({imgIdx:0,annId:c.id,start:[T.clientX,T.clientY],last:[T.clientX,T.clientY]})}}),s.jsx(We,{cx:O+te+Y+Ie+Me,cy:V-b/2-Y-Ie-Me,onPointerUp:T=>{T.stopPropagation(),Z.current?n.forEach(D=>M(D.id,c.id)):M(n[0].id,c.id)}})]})]},c.id)}return null}),u&&(Z.current||n[0].id===u.imageId)&&(u.type==="rect"?s.jsx("rect",{x:Math.min(u.start[0],u.points[2]),y:Math.min(u.start[1],u.points[3]),width:Math.abs(u.points[2]-u.start[0]),height:Math.abs(u.points[3]-u.start[1]),stroke:g,strokeWidth:h,vectorEffect:"non-scaling-stroke",fill:"none",pointerEvents:"none"}):u.type==="ellipse"?s.jsx("ellipse",{cx:(u.start[0]+u.points[2])/2,cy:(u.start[1]+u.points[3])/2,rx:Math.abs(u.points[2]-u.start[0])/2,ry:Math.abs(u.points[3]-u.start[1])/2,stroke:g,strokeWidth:h,vectorEffect:"non-scaling-stroke",fill:"none",pointerEvents:"none"}):u.type==="pen"&&u.points.length>=4?s.jsx("path",{d:`M${u.points[0]},${u.points[1]} `+u.points.slice(2).map((c,m)=>m%2===0?`L${u.points[m+2]},${u.points[m+3]}`:"").join(" "),stroke:g,strokeWidth:h,vectorEffect:"non-scaling-stroke",fill:"none",strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none"}):null)]}),s.jsx(gr,{imageInfo:n[0]})]})},n[0].id)}):s.jsx("div",{className:"grid gap-4 w-full md:w-[90%] h-full items-center justify-center px-4 mx-auto",style:{gridTemplateColumns:`repeat(${n.length}, minmax(0, 1fr))`},children:n.map((c,m)=>{var I,N,O,V,W,te;return s.jsx("div",{className:"relative w-full h-full flex items-center justify-center",children:s.jsxs("div",{ref:b=>A.current[m]=b,className:`w-full h-[80vh] ${e?"bg-black":"bg-white"} rounded-lg shadow-lg overflow-hidden relative group`,children:[i&&s.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 bottom-36 z-30 flex flex-row items-end space-x-3 select-none mb-4",children:pt.map((b,T)=>{var Q;const D=((Q=j[m])==null?void 0:Q.scale)||1;let B=!1;T===0&&D>=1&&D<2&&(B=!0),T===1&&D>=2&&D<5&&(B=!0),T===2&&D>=5&&(B=!0);const L=Number.isInteger(D)?`${D}x`:`${D.toFixed(1)}x`;return s.jsx("button",{onClick:()=>Tn(m,T),className:`w-9 h-9 flex items-center justify-center rounded-full font-semibold transition-all duration-200 shadow-md
                            border border-gray-300 dark:border-gray-700
                            bg-white/80 dark:bg-gray-900/80 backdrop-blur-md
                            hover:bg-sky-100/80 dark:hover:bg-gray-800/90
                            focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-50
                          `,style:{minWidth:36,minHeight:36,maxWidth:36,maxHeight:36,outline:"none",position:"relative",transform:B?"scale(1.22)":"scale(1)"},title:`${b}x`,children:B?s.jsx("span",{className:"text-gray-700 dark:text-gray-100 font-medium whitespace-nowrap text-[13px] leading-none drop-shadow-sm",children:L}):s.jsxs("span",{className:"text-gray-700 dark:text-gray-200 font-medium whitespace-nowrap text-[13px] leading-none drop-shadow-sm",children:[b,"x"]})},b)})}),s.jsx("img",{ref:b=>U.current[m]=b,src:c.url,alt:c.exif.FileName,className:"w-full h-full object-contain select-none",style:{transform:`translate(${((I=j[m])==null?void 0:I.x)||0}px, ${((N=j[m])==null?void 0:N.y)||0}px) scale(${((O=j[m])==null?void 0:O.scale)||1})`,touchAction:"none",userSelect:"none",WebkitUserSelect:"none"},draggable:!1}),s.jsxs("svg",{className:"absolute inset-0 w-full h-full z-20",style:{transform:`translate(${((V=j[m])==null?void 0:V.x)||0}px, ${((W=j[m])==null?void 0:W.y)||0}px) scale(${((te=j[m])==null?void 0:te.scale)||1})`,pointerEvents:l?"auto":"none",touchAction:"none",userSelect:"none",WebkitUserSelect:"none"},onPointerDown:l?b=>En(b,m):void 0,onPointerMove:l?b=>Nn(b,m):void 0,onPointerUp:l?b=>Mn(b,m):void 0,children:[(v[c.id]||[]).map(b=>{var D;const T=S[c.id]===b.id;if(b.type==="rect"){const[B,L,Q,xe]=b.points,we=Math.min(B,Q),ue=Math.min(L,xe),ae=Math.abs(Q-B),ke=Math.abs(xe-L);return s.jsxs("g",{children:[s.jsx("rect",{x:we,y:ue,width:ae,height:ke,stroke:b.color,strokeWidth:b.strokeWidth,vectorEffect:"non-scaling-stroke",fill:"none",onPointerDown:fe=>{fe.stopPropagation(),w(c.id,b.id),d==="move"&&(Z.current?n.forEach(Be=>Se.getState().pushUndo(Be.id,v[Be.id]||[])):Se.getState().pushUndo(c.id,v[c.id]||[])),Ve({x:fe.clientX,y:fe.clientY,annId:b.id,imgIdx:m})}}),d==="move"&&T&&s.jsxs("g",{children:[s.jsx("rect",{x:we-Y,y:ue-Y,width:ae+Y*2,height:ke+Y*2,stroke:"#007AFF",strokeWidth:2,fill:"none",rx:He,strokeDasharray:"4 4",style:{filter:"drop-shadow(0 0 2px #007AFF88)"},pointerEvents:"all",onPointerDown:fe=>{fe.stopPropagation(),$({imgIdx:m,annId:b.id,start:[fe.clientX,fe.clientY],last:[fe.clientX,fe.clientY]})}}),s.jsx(We,{cx:we+ae+Y+Ie+Me,cy:ue-Y-Ie-Me,onPointerUp:fe=>{fe.stopPropagation(),Z.current?n.forEach(Be=>M(Be.id,b.id)):M(c.id,b.id)}})]})]},b.id)}if(b.type==="ellipse"){const[B,L,Q,xe]=b.points,we=Math.min(B,Q),ue=Math.min(L,xe),ae=Math.abs(Q-B),ke=Math.abs(xe-L);return s.jsxs("g",{children:[s.jsx("ellipse",{cx:(B+Q)/2,cy:(L+xe)/2,rx:ae/2,ry:ke/2,stroke:b.color,strokeWidth:b.strokeWidth,vectorEffect:"non-scaling-stroke",fill:"none",onPointerDown:fe=>{fe.stopPropagation(),w(c.id,b.id),d==="move"&&(Z.current?n.forEach(Be=>Se.getState().pushUndo(Be.id,v[Be.id]||[])):Se.getState().pushUndo(c.id,v[c.id]||[])),Ve({x:fe.clientX,y:fe.clientY,annId:b.id,imgIdx:m})}}),d==="move"&&T&&s.jsxs("g",{children:[s.jsx("rect",{x:we-Y,y:ue-Y,width:ae+Y*2,height:ke+Y*2,stroke:"#007AFF",strokeWidth:2,fill:"none",rx:He,strokeDasharray:"4 4",style:{filter:"drop-shadow(0 0 2px #007AFF88)"},pointerEvents:"all",onPointerDown:fe=>{fe.stopPropagation(),$({imgIdx:m,annId:b.id,start:[fe.clientX,fe.clientY],last:[fe.clientX,fe.clientY]})}}),s.jsx(We,{cx:we+ae+Y+Ie+Me,cy:ue-Y-Ie-Me,onPointerUp:fe=>{fe.stopPropagation(),Z.current?n.forEach(Be=>M(Be.id,b.id)):M(c.id,b.id)}})]})]},b.id)}if(b.type==="pen"){const B=b.points,L=B.length>=4?`M${B[0]},${B[1]} `+B.slice(2).map((ae,ke)=>ke%2===0?`L${B[ke+2]},${B[ke+3]}`:"").join(" "):"";let Q=1/0,xe=1/0,we=-1/0,ue=-1/0;for(let ae=0;ae<B.length;ae+=2)Q=Math.min(Q,B[ae]),xe=Math.min(xe,B[ae+1]),we=Math.max(we,B[ae]),ue=Math.max(ue,B[ae+1]);return s.jsxs("g",{children:[s.jsx("path",{d:L,stroke:b.color,strokeWidth:b.strokeWidth,vectorEffect:"non-scaling-stroke",fill:"none",strokeLinejoin:"round",strokeLinecap:"round",onPointerDown:ae=>{ae.stopPropagation(),w(c.id,b.id),d==="move"&&(Z.current?n.forEach(ke=>Se.getState().pushUndo(ke.id,v[ke.id]||[])):Se.getState().pushUndo(c.id,v[c.id]||[])),Ve({x:ae.clientX,y:ae.clientY,annId:b.id,imgIdx:m})}}),d==="move"&&T&&s.jsxs("g",{children:[s.jsx("rect",{x:Q-Y,y:xe-Y,width:we-Q+Y*2,height:ue-xe+Y*2,stroke:"#007AFF",strokeWidth:2,fill:"none",rx:He,strokeDasharray:"4 4",style:{filter:"drop-shadow(0 0 2px #007AFF88)"},pointerEvents:"all",onPointerDown:ae=>{ae.stopPropagation(),$({imgIdx:m,annId:b.id,start:[ae.clientX,ae.clientY],last:[ae.clientX,ae.clientY]})}}),s.jsx(We,{cx:we+Y+Ie+Me,cy:xe-Y-Ie-Me,onPointerUp:ae=>{ae.stopPropagation(),Z.current?n.forEach(ke=>M(ke.id,b.id)):M(c.id,b.id)}})]})]},b.id)}if(b.type==="text"){const[B,L]=b.points,Q=(((D=b.text)==null?void 0:D.length)||0)*(b.fontSize||18)*.96,xe=Math.max(120,Q+16),we=40;return ee===b.id?null:s.jsxs("g",{children:[s.jsx("text",{x:B,y:L,fontSize:b.fontSize||18,fill:b.color,textAnchor:"start",alignmentBaseline:"middle",style:{cursor:d==="move"?"move":"text",userSelect:"none",...T?{filter:"drop-shadow(0 0 2px #007AFF88)"}:{}},onDoubleClick:()=>ce==null?void 0:ce(b.id),onPointerDown:ue=>{ue.stopPropagation(),d==="move"&&(w(c.id,b.id),$({imgIdx:m,annId:b.id,start:[ue.clientX,ue.clientY],last:[ue.clientX,ue.clientY]}))},children:b.text}),d==="move"&&T&&s.jsxs("g",{children:[s.jsx("rect",{x:B-Y,y:L-we/2-Y,width:xe+Y*2,height:we+Y*2,stroke:"#007AFF",strokeWidth:2,fill:"none",rx:He,strokeDasharray:"4 4",style:{filter:"drop-shadow(0 0 2px #007AFF88)"},pointerEvents:"all",onPointerDown:ue=>{ue.stopPropagation(),$({imgIdx:m,annId:b.id,start:[ue.clientX,ue.clientY],last:[ue.clientX,ue.clientY]})}}),s.jsx(We,{cx:B+xe+Y+Ie+Me,cy:L-we/2-Y-Ie-Me,onPointerUp:ue=>{ue.stopPropagation(),Z.current?n.forEach(ae=>M(ae.id,b.id)):M(c.id,b.id)}})]})]},b.id)}return null}),u&&(Z.current||c.id===u.imageId)&&(u.type==="rect"?s.jsx("rect",{x:Math.min(u.start[0],u.points[2]),y:Math.min(u.start[1],u.points[3]),width:Math.abs(u.points[2]-u.start[0]),height:Math.abs(u.points[3]-u.start[1]),stroke:g,strokeWidth:h,vectorEffect:"non-scaling-stroke",fill:"none",pointerEvents:"none"}):u.type==="ellipse"?s.jsx("ellipse",{cx:(u.start[0]+u.points[2])/2,cy:(u.start[1]+u.points[3])/2,rx:Math.abs(u.points[2]-u.start[0])/2,ry:Math.abs(u.points[3]-u.start[1])/2,stroke:g,strokeWidth:h,vectorEffect:"non-scaling-stroke",fill:"none",pointerEvents:"none"}):u.type==="pen"&&u.points.length>=4?s.jsx("path",{d:`M${u.points[0]},${u.points[1]} `+u.points.slice(2).map((b,T)=>T%2===0?`L${u.points[T+2]},${u.points[T+3]}`:"").join(" "),stroke:g,strokeWidth:h,vectorEffect:"non-scaling-stroke",fill:"none",strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none"}):null)]}),!r&&s.jsx("button",{onClick:()=>{o(c.id)},className:`absolute top-2 right-2 z-50 p-1.5 rounded-full transition-all duration-200 opacity-0 group-hover:opacity-100
                      ${e?"bg-gray-800/90 text-gray-100 hover:bg-gray-700":"bg-white/80 text-gray-700 hover:bg-white"}`,title:"",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx(gr,{imageInfo:c})]})},c.id)})}),qr]})};var _r={exports:{}};(function(n){(function(e){var t=u(),r=se(),i=ee(),o=ce(),a={imagePlaceholder:void 0,cacheBust:!1},l={toSvg:d,toPng:h,toJpeg:x,toBlob:v,toPixelData:g,impl:{fontFaces:i,images:o,util:t,inliner:r,options:{}}};n.exports=l;function d(M,A){return A=A||{},F(A),Promise.resolve(M).then(function(j){return E(j,A.filter,!0)}).then(P).then(S).then(U).then(function(j){return w(j,A.width||t.width(M),A.height||t.height(M))});function U(j){return A.bgcolor&&(j.style.backgroundColor=A.bgcolor),A.width&&(j.style.width=A.width+"px"),A.height&&(j.style.height=A.height+"px"),A.style&&Object.keys(A.style).forEach(function(G){j.style[G]=A.style[G]}),j}}function g(M,A){return k(M,A||{}).then(function(U){return U.getContext("2d").getImageData(0,0,t.width(M),t.height(M)).data})}function h(M,A){return k(M,A||{}).then(function(U){return U.toDataURL()})}function x(M,A){return A=A||{},k(M,A).then(function(U){return U.toDataURL("image/jpeg",A.quality||1)})}function v(M,A){return k(M,A||{}).then(t.canvasToBlob)}function F(M){typeof M.imagePlaceholder>"u"?l.impl.options.imagePlaceholder=a.imagePlaceholder:l.impl.options.imagePlaceholder=M.imagePlaceholder,typeof M.cacheBust>"u"?l.impl.options.cacheBust=a.cacheBust:l.impl.options.cacheBust=M.cacheBust}function k(M,A){return d(M,A).then(t.makeImage).then(t.delay(100)).then(function(j){var G=U(M);return G.getContext("2d").drawImage(j,0,0),G});function U(j){var G=document.createElement("canvas");if(G.width=A.width||t.width(j),G.height=A.height||t.height(j),A.bgcolor){var J=G.getContext("2d");J.fillStyle=A.bgcolor,J.fillRect(0,0,G.width,G.height)}return G}}function E(M,A,U){if(!U&&A&&!A(M))return Promise.resolve();return Promise.resolve(M).then(j).then(function(_){return G(M,_,A)}).then(function(_){return J(M,_)});function j(_){return _ instanceof HTMLCanvasElement?t.makeImage(_.toDataURL()):_.cloneNode(!1)}function G(_,X,$){var y=_.childNodes;if(y.length===0)return Promise.resolve(X);return z(X,t.asArray(y),$).then(function(){return X});function z(ge,re,le){var H=Promise.resolve();return re.forEach(function(he){H=H.then(function(){return E(he,le)}).then(function(pe){pe&&ge.appendChild(pe)})}),H}}function J(_,X){if(!(X instanceof Element))return X;return Promise.resolve().then($).then(y).then(z).then(ge).then(function(){return X});function $(){re(window.getComputedStyle(_),X.style);function re(le,H){le.cssText?H.cssText=le.cssText:he(le,H);function he(pe,Ee){t.asArray(pe).forEach(function(R){Ee.setProperty(R,pe.getPropertyValue(R),pe.getPropertyPriority(R))})}}}function y(){[":before",":after"].forEach(function(le){re(le)});function re(le){var H=window.getComputedStyle(_,le),he=H.getPropertyValue("content");if(he===""||he==="none")return;var pe=t.uid();X.className=X.className+" "+pe;var Ee=document.createElement("style");Ee.appendChild(R(pe,le,H)),X.appendChild(Ee);function R(q,oe,ie){var f="."+q+":"+oe,C=ie.cssText?Ce(ie):Z(ie);return document.createTextNode(f+"{"+C+"}");function Ce(de){var Ne=de.getPropertyValue("content");return de.cssText+" content: "+Ne+";"}function Z(de){return t.asArray(de).map(Ne).join("; ")+";";function Ne(ze){return ze+": "+de.getPropertyValue(ze)+(de.getPropertyPriority(ze)?" !important":"")}}}}}function z(){_ instanceof HTMLTextAreaElement&&(X.innerHTML=_.value),_ instanceof HTMLInputElement&&X.setAttribute("value",_.value)}function ge(){X instanceof SVGElement&&(X.setAttribute("xmlns","http://www.w3.org/2000/svg"),X instanceof SVGRectElement&&["width","height"].forEach(function(re){var le=X.getAttribute(re);le&&X.style.setProperty(re,le)}))}}}function P(M){return i.resolveAll().then(function(A){var U=document.createElement("style");return M.appendChild(U),U.appendChild(document.createTextNode(A)),M})}function S(M){return o.inlineAll(M).then(function(){return M})}function w(M,A,U){return Promise.resolve(M).then(function(j){return j.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(j)}).then(t.escapeXhtml).then(function(j){return'<foreignObject x="0" y="0" width="100%" height="100%">'+j+"</foreignObject>"}).then(function(j){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+A+'" height="'+U+'">'+j+"</svg>"}).then(function(j){return"data:image/svg+xml;charset=utf-8,"+j})}function u(){return{escape:ge,parseExtension:A,mimeType:U,dataAsUrl:z,isDataUrl:j,canvasToBlob:J,resolveUrl:_,getAndEncode:y,uid:X(),delay:re,asArray:le,escapeXhtml:H,makeImage:$,width:he,height:pe};function M(){var R="application/font-woff",q="image/jpeg";return{woff:R,woff2:R,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:q,jpeg:q,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function A(R){var q=/\.([^\.\/]*?)$/g.exec(R);return q?q[1]:""}function U(R){var q=A(R).toLowerCase();return M()[q]||""}function j(R){return R.search(/^(data:)/)!==-1}function G(R){return new Promise(function(q){for(var oe=window.atob(R.toDataURL().split(",")[1]),ie=oe.length,f=new Uint8Array(ie),C=0;C<ie;C++)f[C]=oe.charCodeAt(C);q(new Blob([f],{type:"image/png"}))})}function J(R){return R.toBlob?new Promise(function(q){R.toBlob(q)}):G(R)}function _(R,q){var oe=document.implementation.createHTMLDocument(),ie=oe.createElement("base");oe.head.appendChild(ie);var f=oe.createElement("a");return oe.body.appendChild(f),ie.href=q,f.href=R,f.href}function X(){var R=0;return function(){return"u"+q()+R++;function q(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}}function $(R){return new Promise(function(q,oe){var ie=new Image;ie.onload=function(){q(ie)},ie.onerror=oe,ie.src=R})}function y(R){var q=3e4;return l.impl.options.cacheBust&&(R+=(/\?/.test(R)?"&":"?")+new Date().getTime()),new Promise(function(oe){var ie=new XMLHttpRequest;ie.onreadystatechange=Ce,ie.ontimeout=Z,ie.responseType="blob",ie.timeout=q,ie.open("GET",R,!0),ie.send();var f;if(l.impl.options.imagePlaceholder){var C=l.impl.options.imagePlaceholder.split(/,/);C&&C[1]&&(f=C[1])}function Ce(){if(ie.readyState===4){if(ie.status!==200){f?oe(f):de("cannot fetch resource: "+R+", status: "+ie.status);return}var Ne=new FileReader;Ne.onloadend=function(){var ze=Ne.result.split(/,/)[1];oe(ze)},Ne.readAsDataURL(ie.response)}}function Z(){f?oe(f):de("timeout of "+q+"ms occured while fetching resource: "+R)}function de(Ne){console.error(Ne),oe("")}})}function z(R,q){return"data:"+q+";base64,"+R}function ge(R){return R.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function re(R){return function(q){return new Promise(function(oe){setTimeout(function(){oe(q)},R)})}}function le(R){for(var q=[],oe=R.length,ie=0;ie<oe;ie++)q.push(R[ie]);return q}function H(R){return R.replace(/#/g,"%23").replace(/\n/g,"%0A")}function he(R){var q=Ee(R,"border-left-width"),oe=Ee(R,"border-right-width");return R.scrollWidth+q+oe}function pe(R){var q=Ee(R,"border-top-width"),oe=Ee(R,"border-bottom-width");return R.scrollHeight+q+oe}function Ee(R,q){var oe=window.getComputedStyle(R).getPropertyValue(q);return parseFloat(oe.replace("px",""))}}function se(){var M=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:G,shouldProcess:A,impl:{readUrls:U,inline:j}};function A(J){return J.search(M)!==-1}function U(J){for(var _=[],X;(X=M.exec(J))!==null;)_.push(X[1]);return _.filter(function($){return!t.isDataUrl($)})}function j(J,_,X,$){return Promise.resolve(_).then(function(z){return X?t.resolveUrl(z,X):z}).then($||t.getAndEncode).then(function(z){return t.dataAsUrl(z,t.mimeType(_))}).then(function(z){return J.replace(y(_),"$1"+z+"$3")});function y(z){return new RegExp(`(url\\(['"]?)(`+t.escape(z)+`)(['"]?\\))`,"g")}}function G(J,_,X){if($())return Promise.resolve(J);return Promise.resolve(J).then(U).then(function(y){var z=Promise.resolve(J);return y.forEach(function(ge){z=z.then(function(re){return j(re,ge,_,X)})}),z});function $(){return!A(J)}}}function ee(){return{resolveAll:M,impl:{readAll:A}};function M(){return A().then(function(U){return Promise.all(U.map(function(j){return j.resolve()}))}).then(function(U){return U.join(`
`)})}function A(){return Promise.resolve(t.asArray(document.styleSheets)).then(j).then(U).then(function(J){return J.map(G)});function U(J){return J.filter(function(_){return _.type===CSSRule.FONT_FACE_RULE}).filter(function(_){return r.shouldProcess(_.style.getPropertyValue("src"))})}function j(J){var _=[];return J.forEach(function(X){try{t.asArray(X.cssRules||[]).forEach(_.push.bind(_))}catch($){console.log("Error while reading CSS rules from "+X.href,$.toString())}}),_}function G(J){return{resolve:function(){var X=(J.parentStyleSheet||{}).href;return r.inlineAll(J.cssText,X)},src:function(){return J.style.getPropertyValue("src")}}}}}function ce(){return{inlineAll:A,impl:{newImage:M}};function M(U){return{inline:j};function j(G){return t.isDataUrl(U.src)?Promise.resolve():Promise.resolve(U.src).then(G||t.getAndEncode).then(function(J){return t.dataAsUrl(J,t.mimeType(U.src))}).then(function(J){return new Promise(function(_,X){U.onload=_,U.onerror=X,U.src=J})})}}function A(U){if(!(U instanceof Element))return Promise.resolve(U);return j(U).then(function(){return U instanceof HTMLImageElement?M(U).inline():Promise.all(t.asArray(U.childNodes).map(function(G){return A(G)}))});function j(G){var J=G.style.getPropertyValue("background");return J?r.inlineAll(J).then(function(_){G.style.setProperty("background",_,G.style.getPropertyPriority("background"))}).then(function(){return G}):Promise.resolve(G)}}}})()})(_r);var ws=_r.exports;const ks=kr(ws),Mt=({text:n,children:e})=>{const[t,r]=p.useState(!1),{darkMode:i}=Oe();return s.jsxs("div",{className:"relative inline-block",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[e,t&&s.jsxs("div",{className:`absolute top-full left-1/2 transform -translate-x-1/2 translate-y-1 px-2 py-1 text-xs rounded whitespace-nowrap z-50 mt-1
            ${i?"bg-gray-800 text-gray-200 border border-gray-700":"bg-white text-gray-700 border border-gray-200"} shadow-lg`,children:[n,s.jsx("div",{className:`absolute bottom-full left-1/2 transform -translate-x-1/2 border-4 border-transparent 
              ${i?"border-b-gray-800":"border-b-white"}`})]})]})},Ss=({isOpen:n,onClose:e})=>{const{exifSettings:t,toggleExifSetting:r,toggleAllExifSettings:i,showZoomControls:o,toggleShowZoomControls:a,darkMode:l,showExifInfo:d,toggleShowExifInfo:g}=Oe(),[h,x]=ne.useState(n),[v,F]=ne.useState(!1);if(ne.useEffect(()=>{if(n){x(!0),F(!1);const u=requestAnimationFrame(()=>F(!0));return()=>cancelAnimationFrame(u)}else if(h){const u=requestAnimationFrame(()=>F(!1)),se=setTimeout(()=>x(!1),320);return()=>{cancelAnimationFrame(u),clearTimeout(se)}}},[n]),!h)return null;const k={FileName:"",Resolution:"",Make:"",Model:"",LensModel:"",FocalLength:"",FNumber:"",ExposureTime:"",ISO:"ISO",DateTimeOriginal:""},E=["Make","Model","FocalLength","FNumber","ExposureTime","ISO"],P=["LensModel","FileName","Resolution","DateTimeOriginal"];Object.values(t).every(Boolean);const S=E.every(u=>t[u]),w=P.every(u=>t[u]);return bt.createPortal(s.jsxs("div",{className:`fixed right-8 top-20 min-w-[260px] max-w-[90vw] md:max-w-[400px] max-h-[80vh] overflow-y-auto rounded-3xl px-7 py-4 backdrop-blur-lg text-sm shadow-lg shadow-black/10 transition-all duration-300 scrollbar-hide pointer-events-auto select-none z-[2000] 
        ${l?"bg-gray-900/95 text-gray-100 border border-gray-700":"bg-white/80 text-gray-700 border border-gray-200"}`,style:{opacity:v?1:0,transform:v?"scale(1) translateY(0px)":"scale(0.95) translateY(40px)",transition:"opacity 0.32s cubic-bezier(.4,0,.2,1), transform 0.32s cubic-bezier(.4,0,.2,1)",pointerEvents:h?"auto":"none"},children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("h3",{className:"text-base font-semibold text-gray-800 dark:text-gray-100",children:""}),s.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 dark:text-gray-300 dark:hover:text-gray-100",children:s.jsx("span",{className:"text-lg",children:""})})]}),s.jsxs("div",{className:"flex items-center justify-between mt-1 mb-2",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-100",children:"EXIF"}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer select-none",children:[s.jsx("input",{type:"checkbox",checked:d,onChange:g,className:"sr-only peer"}),s.jsx("div",{className:`w-11 h-6 bg-gray-300 dark:bg-gray-800 rounded-full peer-focus:ring-2 peer-focus:ring-sky-400 peer-focus:ring-opacity-50 transition-colors duration-200
            ${d?"bg-sky-500":l?"bg-gray-800":"bg-gray-300"}`,children:s.jsx("div",{className:`absolute top-0.5 left-0.5 w-5 h-5 rounded-full bg-white shadow-md transition-transform duration-200
              ${d?"translate-x-5":"translate-x-0"}`})})]})]}),d&&s.jsxs("div",{className:"flex flex-row gap-3 mb-2",children:[s.jsxs("div",{className:"flex-1 min-w-[120px]",children:[s.jsxs("div",{className:"flex items-center mb-1",children:[s.jsx("input",{type:"checkbox",checked:S,onChange:()=>{S?E.forEach(u=>{t[u]&&r(u)}):E.forEach(u=>{t[u]||r(u)})},className:"form-checkbox h-3.5 w-3.5 text-sky-500 rounded border-gray-300 focus:ring-sky-500 dark:border-gray-600 dark:bg-gray-700 dark:checked:bg-sky-500 mr-1"}),s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-300",children:""})]}),s.jsx("div",{className:"space-y-1",children:E.map(u=>s.jsxs("label",{className:"flex items-center space-x-1 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md transition-colors",children:[s.jsx("input",{type:"checkbox",checked:t[u],onChange:()=>r(u),className:"form-checkbox h-3.5 w-3.5 text-sky-500 rounded border-gray-300 focus:ring-sky-500 dark:border-gray-600 dark:bg-gray-700 dark:checked:bg-sky-500"}),s.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-100",children:k[u]||u})]},u))})]}),s.jsxs("div",{className:"flex-1 min-w-[120px]",children:[s.jsxs("div",{className:"flex items-center mb-1",children:[s.jsx("input",{type:"checkbox",checked:w,onChange:()=>{w?P.forEach(u=>{t[u]&&r(u)}):P.forEach(u=>{t[u]||r(u)})},className:"form-checkbox h-3.5 w-3.5 text-sky-500 rounded border-gray-300 focus:ring-sky-500 dark:border-gray-600 dark:bg-gray-700 dark:checked:bg-sky-500 mr-1"}),s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-300",children:""})]}),s.jsx("div",{className:"space-y-1",children:P.map(u=>s.jsxs("label",{className:"flex items-center space-x-1 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md transition-colors",children:[s.jsx("input",{type:"checkbox",checked:t[u],onChange:()=>r(u),className:"form-checkbox h-3.5 w-3.5 text-sky-500 rounded border-gray-300 focus:ring-sky-500 dark:border-gray-600 dark:bg-gray-700 dark:checked:bg-sky-500"}),s.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-100",children:k[u]||u})]},u))})]})]}),s.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 my-3"}),s.jsxs("div",{className:"flex items-center justify-between mt-1 mb-2",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-100",children:""}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer select-none",children:[s.jsx("input",{type:"checkbox",checked:o,onChange:a,className:"sr-only peer"}),s.jsx("div",{className:`w-11 h-6 bg-gray-300 dark:bg-gray-800 rounded-full peer-focus:ring-2 peer-focus:ring-sky-400 peer-focus:ring-opacity-50 transition-colors duration-200
            ${o?"bg-sky-500":l?"bg-gray-800":"bg-gray-300"}`,children:s.jsx("div",{className:`absolute top-0.5 left-0.5 w-5 h-5 rounded-full bg-white shadow-md transition-transform duration-200
              ${o?"translate-x-5":"translate-x-0"}`})})]})]})]}),document.body)},Cs=()=>{const{darkMode:n,toggleDarkMode:e,demoMode:t,toggleDemoMode:r}=Oe(),{images:i,addImages:o,clearImages:a}=ht(),[l,d]=p.useState(!1),g=p.useRef(null),[h,x]=p.useState(!1),[v,F]=p.useState(!1),k=p.useRef(null),E=async S=>{if(!S)return;const w=Array.from(S).filter(se=>se.type.startsWith("image/"));if(w.length===0)return;a();const u=await Promise.all(w.map(hn));o(u)},P=async()=>{var S,w;try{x(!0),document.body.classList.add("demo-mode-active"),await new Promise(j=>setTimeout(j,300));const u=document.querySelector("main");if(!u)throw new Error("");const se=await ks.toBlob(u,{quality:.95,bgcolor:n?"#000000":"#f9fafb",height:u.scrollHeight,width:u.scrollWidth,style:{transform:"none","transform-origin":"center",zoom:"1"}});let ee="ComparePhotos";if(i.length>0){const j=i[0],G=((S=j.exif)==null?void 0:S.Make)||"",J=((w=j.exif)==null?void 0:w.Model)||"";(G||J)&&(ee+="_"+(G+J).trim().replace(/\s+/g,"-"))}const ce=new Date,M=ce.getFullYear()+("0"+(ce.getMonth()+1)).slice(-2)+("0"+ce.getDate()).slice(-2)+("0"+ce.getHours()).slice(-2)+("0"+ce.getMinutes()).slice(-2);ee+="_"+M+".png";const A=URL.createObjectURL(se),U=document.createElement("a");U.href=A,U.download=ee,U.click(),URL.revokeObjectURL(A),document.body.classList.remove("demo-mode-active"),x(!1)}catch(u){console.error(":",u),document.body.classList.remove("demo-mode-active"),x(!1),alert("")}};return p.useEffect(()=>{if(!v)return;const S=w=>{k.current&&!k.current.contains(w.target)&&F(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[v]),i.length===0?null:s.jsxs("div",{className:"flex items-center space-x-4 setting-bar",children:[s.jsx("div",{className:"relative",children:s.jsx(Mt,{text:"",children:s.jsx("button",{onClick:P,disabled:h,className:`p-3 rounded-full backdrop-blur-md transition-all duration-200 border font-medium flex items-center
              ${n?"bg-gray-900 hover:bg-gray-800 text-white border-gray-700":"bg-sky-500/10 hover:bg-sky-500/20 text-gray-900 border-gray-200"}
              ${h?"opacity-50 cursor-not-allowed":""}`,children:s.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),s.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})})}),s.jsxs("div",{className:"relative",children:[s.jsx(Mt,{text:"",children:s.jsx("button",{onClick:()=>F(S=>!S),className:`p-3 rounded-full backdrop-blur-md transition-all duration-200 border font-medium flex items-center
              ${n?"bg-gray-900 hover:bg-gray-800 text-white border-gray-700":"bg-sky-500/10 hover:bg-sky-500/20 text-gray-900 border-gray-200"}`,children:s.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("circle",{cx:"12",cy:"12",r:"3"}),s.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})}),v&&s.jsx("div",{ref:k,style:{position:"absolute",right:0,top:"100%",zIndex:2e3},onMouseDown:S=>S.stopPropagation(),children:s.jsx(Ss,{isOpen:v,onClose:()=>F(!1)})})]}),s.jsx(Mt,{text:"",children:s.jsx("button",{onClick:r,className:`p-3 rounded-full backdrop-blur-md transition-all duration-200 ${t?"bg-sky-600 hover:bg-sky-700 text-white":n?"bg-gray-900 hover:bg-gray-800 text-white":"bg-sky-500/10 hover:bg-sky-500/20 text-gray-900 dark:text-white"} font-medium desktop-only`,children:s.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:s.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})}),s.jsx("input",{ref:g,type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:S=>E(S.target.files)}),s.jsx("button",{onClick:()=>{var S;return(S=g.current)==null?void 0:S.click()},className:`px-7 py-3 rounded-full backdrop-blur-md transition-all duration-200 ${n?"bg-sky-600 hover:bg-sky-700 text-white":"bg-sky-500 hover:bg-sky-600 text-white"} font-medium text-sm scale-105`,children:""}),s.jsxs("div",{className:"relative desktop-only",children:[s.jsx("input",{type:"file",multiple:!0,accept:"image/*",className:"hidden",id:"add-image-input",onChange:async S=>{if(S.target.files){const w=S.target.files,u=Array.from(w).filter(ee=>ee.type.startsWith("image/"));if(u.length===0)return;const se=await Promise.all(u.map(hn));o(se),S.target.value=""}}}),s.jsx(Mt,{text:"",children:s.jsx("button",{onClick:()=>{var S;return(S=document.getElementById("add-image-input"))==null?void 0:S.click()},className:`p-3 rounded-full backdrop-blur-md transition-all duration-200 ${n?"bg-gray-900 hover:bg-gray-800 text-white":"bg-sky-500/10 hover:bg-sky-500/20 text-gray-900"} font-medium`,children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})]})]})};var Vr={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},mr=ne.createContext&&ne.createContext(Vr),qe=function(){return qe=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},qe.apply(this,arguments)},js=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};function Gr(n){return n&&n.map(function(e,t){return ne.createElement(e.tag,qe({key:t},e.attr),Gr(e.child))})}function Yt(n){return function(e){return ne.createElement(Is,qe({attr:qe({},n.attr)},e),Gr(n.child))}}function Is(n){var e=function(t){var r=n.attr,i=n.size,o=n.title,a=js(n,["attr","size","title"]),l=i||t.size||"1em",d;return t.className&&(d=t.className),n.className&&(d=(d?d+" ":"")+n.className),ne.createElement("svg",qe({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,a,{className:d,style:qe(qe({color:n.color||t.color},t.style),n.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),o&&ne.createElement("title",null,o),n.children)};return mr!==void 0?ne.createElement(mr.Consumer,null,function(t){return e(t)}):e(Vr)}function Ps(n){return Yt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"}}]})(n)}function Es(n){return Yt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"5 9 2 12 5 15"}},{tag:"polyline",attr:{points:"9 5 12 2 15 5"}},{tag:"polyline",attr:{points:"15 19 12 22 9 19"}},{tag:"polyline",attr:{points:"19 9 22 12 19 15"}},{tag:"line",attr:{x1:"2",y1:"12",x2:"22",y2:"12"}},{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"22"}}]})(n)}function Ns(n){return Yt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"4 7 4 4 20 4 20 7"}},{tag:"line",attr:{x1:"9",y1:"20",x2:"15",y2:"20"}},{tag:"line",attr:{x1:"12",y1:"4",x2:"12",y2:"20"}}]})(n)}function Ms(n){return Yt({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"}},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5l-1-1h-5l-1 1H5v2h14V4h-3.5z"}}]})(n)}function Kt(){return(Kt=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n}).apply(this,arguments)}function Xr(n,e){if(n==null)return{};var t,r,i={},o=Object.keys(n);for(r=0;r<o.length;r++)e.indexOf(t=o[r])>=0||(i[t]=n[t]);return i}function gn(n){var e=p.useRef(n),t=p.useRef(function(r){e.current&&e.current(r)});return e.current=n,t.current}var Ct=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n<e?e:n},wt=function(n){return"touches"in n},pn=function(n){return n&&n.ownerDocument.defaultView||self},xr=function(n,e,t){var r=n.getBoundingClientRect(),i=wt(e)?function(o,a){for(var l=0;l<o.length;l++)if(o[l].identifier===a)return o[l];return o[0]}(e.touches,t):e;return{left:Ct((i.pageX-(r.left+pn(n).pageXOffset))/r.width),top:Ct((i.pageY-(r.top+pn(n).pageYOffset))/r.height)}},yr=function(n){!wt(n)&&n.preventDefault()},Yr=ne.memo(function(n){var e=n.onMove,t=n.onKey,r=Xr(n,["onMove","onKey"]),i=p.useRef(null),o=gn(e),a=gn(t),l=p.useRef(null),d=p.useRef(!1),g=p.useMemo(function(){var F=function(P){yr(P),(wt(P)?P.touches.length>0:P.buttons>0)&&i.current?o(xr(i.current,P,l.current)):E(!1)},k=function(){return E(!1)};function E(P){var S=d.current,w=pn(i.current),u=P?w.addEventListener:w.removeEventListener;u(S?"touchmove":"mousemove",F),u(S?"touchend":"mouseup",k)}return[function(P){var S=P.nativeEvent,w=i.current;if(w&&(yr(S),!function(se,ee){return ee&&!wt(se)}(S,d.current)&&w)){if(wt(S)){d.current=!0;var u=S.changedTouches||[];u.length&&(l.current=u[0].identifier)}w.focus(),o(xr(w,S,l.current)),E(!0)}},function(P){var S=P.which||P.keyCode;S<37||S>40||(P.preventDefault(),a({left:S===39?.05:S===37?-.05:0,top:S===40?.05:S===38?-.05:0}))},E]},[a,o]),h=g[0],x=g[1],v=g[2];return p.useEffect(function(){return v},[v]),ne.createElement("div",Kt({},r,{onTouchStart:h,onMouseDown:h,className:"react-colorful__interactive",ref:i,onKeyDown:x,tabIndex:0,role:"slider"}))}),Pn=function(n){return n.filter(Boolean).join(" ")},Kr=function(n){var e=n.color,t=n.left,r=n.top,i=r===void 0?.5:r,o=Pn(["react-colorful__pointer",n.className]);return ne.createElement("div",{className:o,style:{top:100*i+"%",left:100*t+"%"}},ne.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:e}}))},Pe=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t},As=function(n){return Os(mn(n))},mn=function(n){return n[0]==="#"&&(n=n.substring(1)),n.length<6?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?Pe(parseInt(n[3]+n[3],16)/255,2):1}:{r:parseInt(n.substring(0,2),16),g:parseInt(n.substring(2,4),16),b:parseInt(n.substring(4,6),16),a:n.length===8?Pe(parseInt(n.substring(6,8),16)/255,2):1}},Ts=function(n){return Ls(Ds(n))},Fs=function(n){var e=n.s,t=n.v,r=n.a,i=(200-e)*t/100;return{h:Pe(n.h),s:Pe(i>0&&i<200?e*t/100/(i<=100?i:200-i)*100:0),l:Pe(i/2),a:Pe(r,2)}},xn=function(n){var e=Fs(n);return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},Ds=function(n){var e=n.h,t=n.s,r=n.v,i=n.a;e=e/360*6,t/=100,r/=100;var o=Math.floor(e),a=r*(1-t),l=r*(1-(e-o)*t),d=r*(1-(1-e+o)*t),g=o%6;return{r:Pe(255*[r,l,a,a,d,r][g]),g:Pe(255*[d,r,r,l,a,a][g]),b:Pe(255*[a,a,d,r,r,l][g]),a:Pe(i,2)}},At=function(n){var e=n.toString(16);return e.length<2?"0"+e:e},Ls=function(n){var e=n.r,t=n.g,r=n.b,i=n.a,o=i<1?At(Pe(255*i)):"";return"#"+At(e)+At(t)+At(r)+o},Os=function(n){var e=n.r,t=n.g,r=n.b,i=n.a,o=Math.max(e,t,r),a=o-Math.min(e,t,r),l=a?o===e?(t-r)/a:o===t?2+(r-e)/a:4+(e-t)/a:0;return{h:Pe(60*(l<0?l+6:l)),s:Pe(o?a/o*100:0),v:Pe(o/255*100),a:i}},Rs=ne.memo(function(n){var e=n.hue,t=n.onChange,r=Pn(["react-colorful__hue",n.className]);return ne.createElement("div",{className:r},ne.createElement(Yr,{onMove:function(i){t({h:360*i.left})},onKey:function(i){t({h:Ct(e+360*i.left,0,360)})},"aria-label":"Hue","aria-valuenow":Pe(e),"aria-valuemax":"360","aria-valuemin":"0"},ne.createElement(Kr,{className:"react-colorful__hue-pointer",left:e/360,color:xn({h:e,s:100,v:100,a:1})})))}),Us=ne.memo(function(n){var e=n.hsva,t=n.onChange,r={backgroundColor:xn({h:e.h,s:100,v:100,a:1})};return ne.createElement("div",{className:"react-colorful__saturation",style:r},ne.createElement(Yr,{onMove:function(i){t({s:100*i.left,v:100-100*i.top})},onKey:function(i){t({s:Ct(e.s+100*i.left,0,100),v:Ct(e.v-100*i.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+Pe(e.s)+"%, Brightness "+Pe(e.v)+"%"},ne.createElement(Kr,{className:"react-colorful__saturation-pointer",top:1-e.v/100,left:e.s/100,color:xn(e)})))}),Jr=function(n,e){if(n===e)return!0;for(var t in n)if(n[t]!==e[t])return!1;return!0},Bs=function(n,e){return n.toLowerCase()===e.toLowerCase()||Jr(mn(n),mn(e))};function $s(n,e,t){var r=gn(t),i=p.useState(function(){return n.toHsva(e)}),o=i[0],a=i[1],l=p.useRef({color:e,hsva:o});p.useEffect(function(){if(!n.equal(e,l.current.color)){var g=n.toHsva(e);l.current={hsva:g,color:e},a(g)}},[e,n]),p.useEffect(function(){var g;Jr(o,l.current.hsva)||n.equal(g=n.fromHsva(o),l.current.color)||(l.current={hsva:o,color:g},r(g))},[o,n,r]);var d=p.useCallback(function(g){a(function(h){return Object.assign({},h,g)})},[]);return[o,d]}var zs=typeof window<"u"?p.useLayoutEffect:p.useEffect,Hs=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},br=new Map,Ws=function(n){zs(function(){var e=n.current?n.current.ownerDocument:document;if(e!==void 0&&!br.has(e)){var t=e.createElement("style");t.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,br.set(e,t);var r=Hs();r&&t.setAttribute("nonce",r),e.head.appendChild(t)}},[])},_s=function(n){var e=n.className,t=n.colorModel,r=n.color,i=r===void 0?t.defaultColor:r,o=n.onChange,a=Xr(n,["className","colorModel","color","onChange"]),l=p.useRef(null);Ws(l);var d=$s(t,i,o),g=d[0],h=d[1],x=Pn(["react-colorful",e]);return ne.createElement("div",Kt({},a,{ref:l,className:x}),ne.createElement(Us,{hsva:g,onChange:h}),ne.createElement(Rs,{hue:g.h,onChange:h,className:"react-colorful__last-control"}))},Vs={defaultColor:"000",toHsva:As,fromHsva:function(n){return Ts({h:n.h,s:n.s,v:n.v,a:1})},equal:Bs},Gs=function(n){return ne.createElement(_s,Kt({},n,{colorModel:Vs}))};const Tt=["#FF3B30","#FFD60A","#007AFF"],Xs=[2,4,8],Ys=72,Ks=999,Js=[14,18,24],qs=[{type:"move",icon:s.jsx(Es,{size:22,style:{display:"block"}}),label:"/"},{type:"rect",icon:s.jsx("svg",{width:"22",height:"22",viewBox:"0 0 22 22",style:{display:"block"},children:s.jsx("rect",{x:"4",y:"4",width:"14",height:"14",rx:"4",stroke:"currentColor",strokeWidth:"2.2",fill:"none"})}),label:""},{type:"ellipse",icon:s.jsx("svg",{width:"22",height:"22",viewBox:"0 0 22 22",style:{display:"block"},children:s.jsx("ellipse",{cx:"11",cy:"11",rx:"7",ry:"7",stroke:"currentColor",strokeWidth:"2.2",fill:"none"})}),label:""},{type:"pen",icon:s.jsx(Ps,{size:22,style:{display:"block"}}),label:""},{type:"text",icon:s.jsx(Ns,{size:22,style:{display:"block"}}),label:""}];function vr(n=28,e=16,t=1,r=1.35){const i=e/2;let o="";for(let a=0;a<=n;a++){const l=a,d=i+r*Math.sin(a/n*t*2*Math.PI);o+=a===0?`M${l},${d}`:` L${l},${d}`}return o}const yt=({text:n,children:e})=>{const[t,r]=p.useState(!1),{darkMode:i}=Oe();return s.jsxs("div",{className:"relative inline-block",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[e,t&&s.jsxs("div",{className:`absolute top-full left-1/2 transform -translate-x-1/2 translate-y-1 px-2 py-1 text-xs rounded whitespace-nowrap z-50 mt-1
            ${i?"bg-gray-800 text-gray-200 border border-gray-700":"bg-white text-gray-700 border border-gray-200"} shadow-lg`,children:[n,s.jsx("div",{className:`absolute bottom-full left-1/2 transform -translate-x-1/2 border-4 border-transparent
              ${i?"border-b-gray-800":"border-b-white"}`})]})]})},Zs=()=>{const{annotationTool:n,setAnnotationTool:e,annotationStrokeWidth:t,setStrokeWidth:r,annotationColor:i,setAnnotationColor:o,annotationToolbar:a,clearAnnotations:l,isAnnotateMode:d,annotations:g,annotationFontSize:h,setAnnotationFontSize:x}=Se(),[v,F]=p.useState(!1),[k,E]=p.useState("#FF3B30"),P=p.useRef(null),S=p.useRef(null),[w,u]=p.useState(!1),[se,ee]=p.useState(!1),[ce,M]=p.useState({x:0,y:0}),A=p.useRef({x:0,y:0});p.useRef(null);const[U,j]=p.useState({left:0,top:0}),[G,J]=p.useState(!1),_=p.useRef(null),[X,$]=p.useState({left:0,top:0}),[y,z]=p.useState(!1),ge=p.useRef(null),[re,le]=p.useState({left:0,top:0}),{darkMode:H}=Oe();ne.useEffect(()=>{a.visible?(u(!0),setTimeout(()=>{if(P.current){const f=P.current.getBoundingClientRect();M({x:(window.innerWidth-f.width)/2,y:window.innerHeight*.7})}ee(!0)},10),o("#FF3B30"),E("#FF3B30"),r(4)):w&&ee(!1)},[a.visible]),p.useLayoutEffect(()=>{if(!se&&w){const f=setTimeout(()=>u(!1),350);return()=>clearTimeout(f)}},[se,w]);const he=f=>{if(f.target.closest(".toolbar-btn")||f.button!==0||!P.current)return;const C=P.current.getBoundingClientRect();A.current={x:f.clientX-C.left,y:f.clientY-C.top},window.addEventListener("pointermove",pe),window.addEventListener("pointerup",Ee)},pe=f=>{M({x:f.clientX-A.current.x,y:f.clientY-A.current.y})},Ee=()=>{window.removeEventListener("pointermove",pe),window.removeEventListener("pointerup",Ee)},R={position:"fixed",left:ce.x,top:ce.y,zIndex:1e3,width:"fit-content",height:Ys,borderRadius:Ks,background:H?"rgba(24, 26, 32, 0.92)":"rgba(255,255,255,0.92)",backdropFilter:"blur(16px) saturate(1.5)",boxShadow:H?"0 8px 32px rgba(0,0,0,0.38)":"0 8px 32px rgba(0,0,0,0.18)",border:H?"1.5px solid rgba(80,80,100,0.18)":"1.5px solid rgba(180,180,200,0.13)",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:0,userSelect:"none",WebkitUserSelect:"none",touchAction:"none",opacity:se?1:0,pointerEvents:w?"auto":"none",transform:se?"scale(1) translateY(0px)":"scale(0.95) translateY(40px)",transition:"opacity 0.35s cubic-bezier(.4,0,.2,1), transform 0.35s cubic-bezier(.4,0,.2,1)",padding:"0 36px",boxSizing:"border-box",color:H?"#e5e7eb":"#333"};ne.useEffect(()=>{if(v&&S.current){const f=S.current.getBoundingClientRect(),C=220,Ce=170,Z=100;let de=f.left+f.width/2-C/2,Ne=f.top-Ce-Z;Ne<Z&&(Ne=f.bottom+Z),de<8&&(de=8),de+C>window.innerWidth-8&&(de=window.innerWidth-C-8),j({left:de,top:Ne})}},[v,ce]),ne.useEffect(()=>{if(!v)return;const f=C=>{!C.target.closest(".color-popover")&&!C.target.closest(".toolbar-btn")&&F(!1)};return window.addEventListener("mousedown",f),()=>window.removeEventListener("mousedown",f)},[v]);const q={border:"none",borderRadius:"50%",width:40,height:40,minWidth:40,minHeight:40,maxWidth:40,maxHeight:40,display:"flex",alignItems:"center",justifyContent:"center",fontSize:22,transition:"box-shadow 0.18s, background 0.18s",padding:0,overflow:"hidden",background:"transparent"};if(ne.useEffect(()=>{if(G&&_.current){const f=_.current.getBoundingClientRect(),C=48,Ce=140;let Z=f.left+f.width/2-C/2,de=f.top-Ce-12;de<8&&(de=f.bottom+12),Z<8&&(Z=8),Z+C>window.innerWidth-8&&(Z=window.innerWidth-C-8),$({left:Z,top:de})}if(G){const f=C=>{const Ce=document.querySelector(".stroke-menu-popover");Ce&&!Ce.contains(C.target)&&_.current&&!_.current.contains(C.target)&&J(!1)};return window.addEventListener("mousedown",f),()=>window.removeEventListener("mousedown",f)}},[G,ce]),ne.useEffect(()=>{if(y&&ge.current){const f=ge.current.getBoundingClientRect(),C=48,Ce=140;let Z=f.left+f.width/2-C/2,de=f.top-Ce-12;de<8&&(de=f.bottom+12),Z<8&&(Z=8),Z+C>window.innerWidth-8&&(Z=window.innerWidth-C-8),le({left:Z,top:de})}if(y){const f=C=>{const Ce=document.querySelector(".font-menu-popover");Ce&&!Ce.contains(C.target)&&ge.current&&!ge.current.contains(C.target)&&z(!1)};return window.addEventListener("mousedown",f),()=>window.removeEventListener("mousedown",f)}},[y,ce]),!w)return null;const oe=v?bt.createPortal(s.jsxs("div",{className:"color-popover",onPointerDown:f=>f.stopPropagation(),style:{position:"fixed",zIndex:3e3,left:U.left,top:U.top,width:220,background:"rgba(255,255,255,0.98)",borderRadius:18,boxShadow:"0 4px 24px rgba(0,0,0,0.13)",padding:18,display:"flex",flexDirection:"column",alignItems:"center",gap:12,border:"1.5px solid #e0e0e0",opacity:1,pointerEvents:"auto"},onClick:f=>f.stopPropagation(),children:[s.jsx(Gs,{color:k,onChange:f=>{E(f),o(f)},style:{width:180,height:120}}),s.jsx("input",{type:"text",value:k,onChange:f=>{E(f.target.value),o(f.target.value)},style:{width:90,fontSize:15,border:"1px solid #eee",borderRadius:8,padding:"3px 8px",textAlign:"center",marginTop:4},maxLength:9}),s.jsx("button",{style:{marginTop:8,fontSize:13,color:"#888",background:"none",border:"none",cursor:"pointer"},onClick:()=>F(!1),children:""})]}),document.body):null,ie=y?bt.createPortal(s.jsx("div",{className:"font-menu-popover",onPointerDown:f=>f.stopPropagation(),style:{position:"fixed",zIndex:3e3,left:re.left,top:re.top,width:48,background:"rgba(255,255,255,0.98)",borderRadius:25,boxShadow:"0 4px 24px rgba(0,0,0,0.13)",padding:10,display:"flex",flexDirection:"column",alignItems:"center",gap:12,border:"1.5px solid #e0e0e0",opacity:1,pointerEvents:"auto"},children:Js.map(f=>s.jsx("button",{onClick:()=>{x(f),z(!1)},style:{width:32,height:32,borderRadius:"50%",border:"none",background:h===f?"#e6f0ff":"transparent",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"none",margin:0,padding:0,cursor:"pointer",fontSize:f,color:h===f?"#007AFF":"#333"},title:`${f}`,onMouseEnter:C=>C.currentTarget.style.boxShadow="0 0 0 3px #007AFF66",onMouseLeave:C=>C.currentTarget.style.boxShadow=h===f?"0 0 0 3px #007AFF66":"none",onFocus:C=>C.currentTarget.style.boxShadow="0 0 0 3px #007AFF66",onBlur:C=>C.currentTarget.style.boxShadow=h===f?"0 0 0 3px #007AFF66":"none",children:"T"},f))}),document.body):null;return s.jsxs("div",{ref:P,style:R,className:"annotation-toolbar",onPointerDown:he,children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[s.jsx("div",{style:{display:"flex",gap:12},children:qs.map(f=>s.jsx(yt,{text:f.label,children:s.jsx("button",{className:"toolbar-btn",ref:f.type==="text"?ge:void 0,onClick:()=>{e(f.type),f.type==="text"?z(C=>!C):z(!1)},style:{...q,background:n===f.type?"#e6f0ff":"transparent",color:n===f.type?H?"#60a5fa":"#007AFF":H?"#e5e7eb":"#333",boxShadow:n===f.type?"0 0 0 3px #007AFF66":void 0},onMouseEnter:C=>C.currentTarget.style.boxShadow=n===f.type?"0 0 0 3px #007AFF66":"0 0 0 3px #007AFF33",onMouseLeave:C=>C.currentTarget.style.boxShadow=n===f.type?"0 0 0 3px #007AFF66":"none",onFocus:C=>C.currentTarget.style.boxShadow=n===f.type?"0 0 0 3px #007AFF66":"0 0 0 3px #007AFF33",onBlur:C=>C.currentTarget.style.boxShadow=n===f.type?"0 0 0 3px #007AFF66":"none",children:s.jsx("span",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:f.icon})})},f.type))}),s.jsx("div",{className:"annotation-toolbar-divider",style:{height:36,width:1.5,background:H?"rgba(120,120,140,0.28)":"rgba(120,120,140,0.18)",margin:"0 16px"}}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsx(yt,{text:"",children:s.jsx("button",{ref:_,className:"toolbar-btn",onClick:()=>J(f=>!f),style:{...q,background:"transparent",boxShadow:G?"0 0 0 3px #007AFF66":"none",outline:"none",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",padding:0,overflow:"hidden",color:H?"#e5e7eb":"#333"},onMouseEnter:f=>{const C=f.currentTarget.querySelector("path");C&&C.setAttribute("stroke",t?H?"#60a5fa":"#007AFF":H?"#e5e7eb":"#333")},onMouseLeave:f=>{const C=f.currentTarget.querySelector("path");C&&C.setAttribute("stroke",t?H?"#60a5fa":"#007AFF":H?"#e5e7eb":"#333")},onFocus:f=>{const C=f.currentTarget.querySelector("path");C&&C.setAttribute("stroke",t?H?"#60a5fa":"#007AFF":H?"#e5e7eb":"#333")},onBlur:f=>{const C=f.currentTarget.querySelector("path");C&&C.setAttribute("stroke",t?H?"#60a5fa":"#007AFF":H?"#e5e7eb":"#333")},children:s.jsx("span",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx("svg",{width:"28",height:t+16,viewBox:`0 0 28 ${t+16}`,style:{display:"block"},children:s.jsx("path",{d:vr(28,t+16,1,1.35),stroke:H?"#e5e7eb":"#333",strokeWidth:t,fill:"none",strokeLinecap:"round"})})})})}),G&&bt.createPortal(s.jsx("div",{className:"stroke-menu-popover",onPointerDown:f=>f.stopPropagation(),style:{position:"fixed",zIndex:3e3,left:X.left,top:X.top,width:48,background:H?"rgba(24, 26, 32, 0.98)":"rgba(255,255,255,0.98)",borderRadius:25,boxShadow:H?"0 4px 24px rgba(0,0,0,0.38)":"0 4px 24px rgba(0,0,0,0.13)",padding:10,display:"flex",flexDirection:"column",alignItems:"center",gap:12,border:H?"1.5px solid rgba(80,80,100,0.18)":"1.5px solid #e0e0e0",opacity:1,pointerEvents:"auto"},children:Xs.map(f=>s.jsx("button",{onClick:()=>{r(f),J(!1)},style:{width:32,height:32,borderRadius:"50%",border:"none",background:t===f?"#e6f0ff":"transparent",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"none",margin:0,padding:0,cursor:"pointer"},title:`${f}`,onMouseEnter:C=>C.currentTarget.style.boxShadow="0 0 0 3px #007AFF66",onMouseLeave:C=>C.currentTarget.style.boxShadow=t===f?"0 0 0 3px #007AFF66":"none",onFocus:C=>C.currentTarget.style.boxShadow="0 0 0 3px #007AFF66",onBlur:C=>C.currentTarget.style.boxShadow=t===f?"0 0 0 3px #007AFF66":"none",children:s.jsx("svg",{width:"28",height:f+16,viewBox:`0 0 28 ${f+16}`,style:{display:"block"},children:s.jsx("path",{d:vr(28,f+16,1,1.35),stroke:t===f?H?"#60a5fa":"#007AFF":H?"#e5e7eb":"#333",strokeWidth:f,fill:"none",strokeLinecap:"round"})})},f))}),document.body)]}),s.jsx("div",{className:"annotation-toolbar-divider",style:{height:36,width:1.5,background:H?"rgba(120,120,140,0.28)":"rgba(120,120,140,0.18)",margin:"0 16px"}}),s.jsxs("div",{style:{display:"flex",gap:12},children:[Tt.map(f=>s.jsx(yt,{text:f,children:s.jsx("button",{className:"toolbar-btn",onClick:()=>o(f),style:{...q,background:H?"#23272f":"#fff",boxShadow:i===f?"0 0 0 3px #007AFF66":void 0,border:"none",outline:"none",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",padding:0,overflow:"hidden"},onMouseEnter:C=>C.currentTarget.style.boxShadow=i===f?"0 0 0 3px #007AFF66":"0 0 0 3px #007AFF33",onMouseLeave:C=>C.currentTarget.style.boxShadow=i===f?"0 0 0 3px #007AFF66":"none",onFocus:C=>C.currentTarget.style.boxShadow=i===f?"0 0 0 3px #007AFF66":"0 0 0 3px #007AFF33",onBlur:C=>C.currentTarget.style.boxShadow=i===f?"0 0 0 3px #007AFF66":"none",children:s.jsx("span",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx("span",{style:{display:"block",width:25,height:25,borderRadius:"50%",background:f}})})})},f)),s.jsx(yt,{text:"",children:s.jsx("button",{ref:S,className:"toolbar-btn",style:{...q,background:H?"#23272f":"#fff",boxShadow:!Tt.includes(i)&&k===i||v?"0 0 0 3px #007AFF66":"none",outline:"none",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",padding:0,overflow:"hidden"},onClick:()=>F(f=>!f),onMouseEnter:f=>f.currentTarget.style.boxShadow="0 0 0 3px #007AFF66",onMouseLeave:f=>f.currentTarget.style.boxShadow=!Tt.includes(i)&&k===i||v?"0 0 0 3px #007AFF66":"none",onFocus:f=>f.currentTarget.style.boxShadow="0 0 0 3px #007AFF66",onBlur:f=>f.currentTarget.style.boxShadow=!Tt.includes(i)&&k===i||v?"0 0 0 3px #007AFF66":"none",children:s.jsxs("span",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[s.jsxs("svg",{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[s.jsx("circle",{cx:"15",cy:"15",r:"13",stroke:"#bbb",strokeWidth:"3",fill:"none"}),s.jsx("path",{d:"M15 2 A13 13 0 0 1 28 15",stroke:"#FF3B30",strokeWidth:"4",fill:"none"}),s.jsx("path",{d:"M28 15 A13 13 0 0 1 15 28",stroke:"#FFD60A",strokeWidth:"4",fill:"none"}),s.jsx("path",{d:"M15 28 A13 13 0 0 1 2 15",stroke:"#007AFF",strokeWidth:"4",fill:"none"}),s.jsx("path",{d:"M2 15 A13 13 0 0 1 15 2",stroke:"#34C759",strokeWidth:"4",fill:"none"})]}),s.jsx("span",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)",width:20,height:20,borderRadius:"50%",background:k,border:"1.5px solid #eee",boxShadow:"0 0 2px #007AFF44",display:"flex",alignItems:"center",justifyContent:"center"}})]})})})]}),s.jsx("div",{className:"annotation-toolbar-divider",style:{height:36,width:1.5,background:H?"rgba(120,120,140,0.28)":"rgba(120,120,140,0.18)",margin:"0 16px"}}),s.jsx("div",{style:{display:"flex",gap:0},children:s.jsx(yt,{text:"",children:s.jsx("button",{className:"toolbar-btn",onClick:()=>{Object.keys(g).forEach(f=>l(f))},style:{...q,background:H?"#23272f":"#fff",color:"#FF3B30",boxShadow:"none"},onMouseEnter:f=>f.currentTarget.style.boxShadow="0 0 0 3px #FF3B3066",onMouseLeave:f=>f.currentTarget.style.boxShadow="none",onFocus:f=>f.currentTarget.style.boxShadow="0 0 0 3px #FF3B3066",onBlur:f=>f.currentTarget.style.boxShadow="none",children:s.jsx("span",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(Ms,{size:22,style:{display:"block",margin:"auto"}})})})})})]}),oe,ie]})},wr=72,Qs=999,eo=()=>{var _,X;const{keyframes:n,currentIdx:e,setCurrentIdx:t,playing:r,setPlaying:i,enabled:o,frameDuration:a,transitionDuration:l,transitionEasing:d,setFrameDuration:g,setTransitionDuration:h,setTransitionEasing:x}=In(),[v,F]=p.useState(!1),[k,E]=p.useState(!1),[P,S]=p.useState(null),w=p.useRef(null),u=p.useRef({x:0,y:0}),[se,ee]=p.useState(!1),ce=p.useRef(null);p.useEffect(()=>{o?(F(!0),setTimeout(()=>{if(w.current&&!P){const $=w.current.getBoundingClientRect();S({x:(window.innerWidth-$.width)/2,y:window.innerHeight*.7})}E(!0)},10)):v&&E(!1)},[o]),p.useEffect(()=>{if(!k&&v){const $=setTimeout(()=>F(!1),350);return()=>clearTimeout($)}},[k,v]);const M=$=>{if($.target.closest("button")||$.button!==0||!w.current)return;const y=w.current.getBoundingClientRect();u.current={x:$.clientX-y.left,y:$.clientY-y.top},window.addEventListener("pointermove",A),window.addEventListener("pointerup",U)},A=$=>{S(y=>y&&{x:$.clientX-u.current.x,y:$.clientY-u.current.y})},U=()=>{window.removeEventListener("pointermove",A),window.removeEventListener("pointerup",U)},j=()=>{var $;return P?P.x:(window.innerWidth-((($=w.current)==null?void 0:$.offsetWidth)||0))/2},G=()=>P?P.y:window.innerHeight*.7;if(p.useEffect(()=>{if(!se)return;const $=y=>{ce.current&&!ce.current.contains(y.target)&&w.current&&!w.current.contains(y.target)&&ee(!1)};return document.addEventListener("mousedown",$),()=>document.removeEventListener("mousedown",$)},[se]),p.useEffect(()=>{l!==1e3&&h(1e3)},[]),!v)return null;const J={position:"fixed",left:j(),top:G(),zIndex:1e3,width:"fit-content",height:wr,borderRadius:Qs,background:"rgba(255,255,255,0.92)",backdropFilter:"blur(16px) saturate(1.5)",boxShadow:"0 8px 32px rgba(0,0,0,0.18)",border:"1.5px solid rgba(180,180,200,0.13)",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:0,userSelect:"none",WebkitUserSelect:"none",touchAction:"none",opacity:k?1:0,pointerEvents:v?"auto":"none",transform:k?"scale(1) translateY(0px)":"scale(0.95) translateY(40px)",transition:"opacity 0.35s cubic-bezier(.4,0,.2,1), transform 0.35s cubic-bezier(.4,0,.2,1)",padding:"0 36px",boxSizing:"border-box",color:"#333",cursor:"default"};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{ref:w,className:"keyframe-panel floating-toolbar-panel",style:J,onPointerDown:M,children:[s.jsx("button",{onClick:()=>i(!r),style:{width:40,height:40,borderRadius:"50%",border:"none",background:r?"#e6f0ff":"#fff",color:r?"#007AFF":"#333",display:"flex",alignItems:"center",justifyContent:"center",fontSize:22,boxShadow:r?"0 0 0 3px #007AFF66":void 0,cursor:"pointer",marginRight:24},title:r?"":"",children:r?s.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 22 22",children:[s.jsx("rect",{x:"5",y:"4",width:"4",height:"14",rx:"2",fill:"currentColor"}),s.jsx("rect",{x:"13",y:"4",width:"4",height:"14",rx:"2",fill:"currentColor"})]}):s.jsx("svg",{width:"22",height:"22",viewBox:"0 0 22 22",children:s.jsx("polygon",{points:"6,4 18,11 6,18",fill:"currentColor"})})}),s.jsx("button",{onClick:()=>ee($=>!$),style:{width:36,height:36,borderRadius:"50%",border:"none",background:"#f4f4f4",color:"#888",display:"flex",alignItems:"center",justifyContent:"center",fontSize:18,marginRight:18,cursor:"pointer"},title:"",children:s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[s.jsx("circle",{cx:"10",cy:"10",r:"8",stroke:"currentColor",strokeWidth:"2"}),s.jsx("path",{d:"M10 6v4l2 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),s.jsx("div",{style:{display:"flex",gap:18},children:n.map(($,y)=>s.jsx("button",{onClick:()=>{t(y),r&&i(!1)},style:{width:40,height:40,borderRadius:"50%",border:"none",background:e===y?"#e6f0ff":"#fff",color:e===y?"#007AFF":"#333",display:"flex",alignItems:"center",justifyContent:"center",fontSize:18,boxShadow:e===y?"0 0 0 3px #007AFF66":void 0,cursor:"pointer",position:"relative"},title:`${y+1}${y+1}`,children:y+1},y))})]}),v&&s.jsx("div",{style:{position:"fixed",left:j()+(((_=w.current)==null?void 0:_.offsetWidth)||0)/2,top:G()+wr+8,transform:"translateX(-50%)",zIndex:1100,minWidth:180,textAlign:"center",fontSize:12,color:"#888",fontWeight:400,letterSpacing:.2,userSelect:"none",pointerEvents:"none"},className:"keyframe-hint",children:"1-5/"}),se&&s.jsxs("div",{ref:ce,className:"fixed min-w-[260px] max-w-[90vw] md:max-w-[400px] max-h-[80vh] overflow-y-auto rounded-3xl px-7 py-4 backdrop-blur-lg text-sm shadow-lg shadow-black/10 transition-all duration-300 scrollbar-hide pointer-events-auto select-none z-[2000] bg-white/80 text-gray-700 border border-gray-200",style:{left:j()+(((X=w.current)==null?void 0:X.offsetWidth)||0)/2,top:G()-16,transform:"translate(-50%, -100%)"},onClick:$=>$.stopPropagation(),children:[s.jsxs("div",{style:{marginBottom:20},children:[s.jsx("div",{style:{fontWeight:500,marginBottom:10},children:""}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsx("button",{type:"button",onClick:()=>g(1e3),className:`px-4 py-2 rounded-lg font-medium border transition-all duration-200 focus:outline-none ${a===1e3?"bg-sky-500 text-white border-sky-500 shadow":"bg-gray-100 text-gray-700 border-gray-200 hover:bg-sky-100"}`,children:"1"}),s.jsx("button",{type:"button",onClick:()=>g(3e3),className:`px-4 py-2 rounded-lg font-medium border transition-all duration-200 focus:outline-none ${a===3e3?"bg-sky-500 text-white border-sky-500 shadow":"bg-gray-100 text-gray-700 border-gray-200 hover:bg-sky-100"}`,children:"3"}),s.jsx("button",{type:"button",onClick:()=>g(5e3),className:`px-4 py-2 rounded-lg font-medium border transition-all duration-200 focus:outline-none ${a===5e3?"bg-sky-500 text-white border-sky-500 shadow":"bg-gray-100 text-gray-700 border-gray-200 hover:bg-sky-100"}`,children:"5"})]})]}),s.jsxs("div",{style:{marginBottom:12},children:[s.jsx("div",{style:{fontWeight:500,marginBottom:10},children:""}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsx("button",{type:"button",onClick:()=>h(500),className:`px-4 py-2 rounded-lg font-medium border transition-all duration-200 focus:outline-none ${l===500?"bg-sky-500 text-white border-sky-500 shadow":"bg-gray-100 text-gray-700 border-gray-200 hover:bg-sky-100"}`,children:"0.5"}),s.jsx("button",{type:"button",onClick:()=>h(1e3),className:`px-4 py-2 rounded-lg font-medium border transition-all duration-200 focus:outline-none ${l===1e3?"bg-sky-500 text-white border-sky-500 shadow":"bg-gray-100 text-gray-700 border-gray-200 hover:bg-sky-100"}`,children:"1"}),s.jsx("button",{type:"button",onClick:()=>h(3e3),className:`px-4 py-2 rounded-lg font-medium border transition-all duration-200 focus:outline-none ${l===3e3?"bg-sky-500 text-white border-sky-500 shadow":"bg-gray-100 text-gray-700 border-gray-200 hover:bg-sky-100"}`,children:"3"})]})]})]})]})},to=({isOpen:n,onClose:e,darkMode:t,toggleDarkMode:r,syncZoom:i,toggleSyncZoom:o,images:a})=>s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`sidebar-backdrop ${n?"open":""}`,onClick:e}),s.jsxs("div",{className:`mobile-sidebar ${n?"open":""}`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h2",{className:`text-xl font-semibold ${t?"text-white":"text-gray-900"}`,children:"PhotoCompare"}),s.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400",children:s.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:s.jsx("path",{d:"M18 6L6 18M6 6l12 12",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-3 rounded-lg bg-gray-100 dark:bg-gray-800",children:[a.length>0&&s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:""}),s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"checkbox",checked:i,onChange:o,className:"sr-only peer"}),s.jsx("div",{className:`relative w-11 h-6 rounded-full transition-all duration-200 
                    ${i?"bg-sky-500":t?"bg-gray-700":"bg-gray-300"} 
                    cursor-pointer
                    after:content-[''] after:absolute after:top-0.5 after:left-0.5 
                    after:bg-white after:rounded-full after:h-5 after:w-5 
                    after:shadow-md after:transition-all
                    ${i?"after:translate-x-5":"after:translate-x-0"}`})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:t?"":""}),s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"checkbox",checked:t,onChange:r,className:"sr-only peer"}),s.jsx("div",{className:`relative w-11 h-6 rounded-full transition-all duration-200 
                  ${t?"bg-sky-500":"bg-gray-300"} 
                  cursor-pointer
                  after:content-[''] after:absolute after:top-0.5 after:left-0.5 
                  after:bg-white after:rounded-full after:h-5 after:w-5 
                  after:shadow-md after:transition-all
                  ${t?"after:translate-x-5":"after:translate-x-0"}`})]})]})]}),s.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 text-sm text-gray-500 dark:text-gray-400",children:[s.jsxs("div",{className:"mb-2",children:[" ",new Date().getFullYear()," Jim"]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("a",{href:"https://space.bilibili.com/13818699",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-sky-500",children:[s.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M17.813 4.653h.854c1.51.054 2.769.578 3.773 1.574 1.004.995 1.524 2.249 1.56 3.76v7.36c-.036 1.51-.556 2.769-1.56 3.773s-2.262 1.524-3.773 1.56H5.333c-1.51-.036-2.769-.556-3.773-1.56S.036 18.858 0 17.347v-7.36c.036-1.511.556-2.765 1.56-3.76 1.004-.996 2.262-1.52 3.773-1.574h.774l-1.174-1.12a1.234 1.234 0 0 1-.373-.906c0-.356.124-.658.373-.907l.027-.027c.267-.249.573-.373.92-.373.347 0 .653.124.92.373L9.653 4.44c.071.071.134.142.187.213h4.267a.836.836 0 0 1 .16-.213l2.853-2.747c.267-.249.573-.373.92-.373.347 0 .662.151.929.4.267.249.391.551.391.907 0 .355-.124.657-.373.906L17.813 4.653zM5.333 7.24c-.746.018-1.373.276-1.88.773-.506.498-.769 1.13-.786 1.894v7.52c.017.764.28 1.395.786 1.893.507.498 1.134.756 1.88.773h13.334c.746-.017 1.373-.275 1.88-.773.506-.498.769-1.129.786-1.893v-7.52c-.017-.765-.28-1.396-.786-1.894-.507-.497-1.134-.755-1.88-.773H5.333zM8 11.107c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c0-.373.129-.689.386-.947.258-.257.574-.386.947-.386zm8 0c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c0-.373.129-.689.386-.947.258-.257.574-.386.947-.386zm8 0c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c.017-.391.15-.711.4-.96.249-.249.56-.373.933-.373Z"})}),s.jsx("span",{children:"@Jim"})]}),s.jsx("span",{children:""}),s.jsx("span",{className:"text-sm opacity-60",children:"v1.1.9"})]})]})]})]})]}),no=()=>{const{darkMode:n,toggleDarkMode:e,demoMode:t,toggleDemoMode:r,syncZoom:i,toggleSyncZoom:o}=Oe(),{images:a}=ht(),[l,d]=p.useState(!1),[g,h]=p.useState(!1),[x,v]=p.useState(!1),[F,k]=p.useState(!1),{isAnnotateMode:E,setAnnotateMode:P,setToolbarVisible:S}=Se(),{enabled:w,setEnabled:u}=In();p.useEffect(()=>{n?(document.documentElement.classList.add("dark"),document.documentElement.classList.add("dark-mode")):(document.documentElement.classList.remove("dark"),document.documentElement.classList.remove("dark-mode"))},[n]),p.useEffect(()=>{const ee=()=>{!document.fullscreenElement&&t&&r()};return document.addEventListener("fullscreenchange",ee),()=>{document.removeEventListener("fullscreenchange",ee)}},[t,r]),p.useEffect(()=>{if(t){document.body.classList.add("demo-mode-active"),document.documentElement.requestFullscreen().catch(()=>{r()}),d(!0);const ee=setTimeout(()=>{d(!1)},3e3);return()=>{clearTimeout(ee),document.body.classList.remove("demo-mode-active")}}else document.body.classList.remove("demo-mode-active"),d(!1),document.fullscreenElement&&document.exitFullscreen().catch(()=>{console.error("")})},[t,r]),p.useEffect(()=>{S(E)},[E,S]),p.useEffect(()=>{w&&E&&P(!1)},[w]),p.useEffect(()=>{E&&w&&u(!1)},[E]);const se=w&&!t;return s.jsx("div",{className:`h-screen overflow-hidden ${n?"bg-black":"bg-gray-50"}`,children:s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"fixed top-0 left-0 right-0 h-16 z-50 px-6 flex items-center justify-between backdrop-blur-md bg-white/5 dark:bg-black/50 app-header",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{className:"menu-button mr-2 p-2 rounded-full hover:bg-gray-200/50 dark:hover:bg-gray-800/50 hidden",onClick:()=>k(!0),children:s.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:n?"white":"black",strokeWidth:"2",children:s.jsx("path",{d:"M4 6h16M4 12h16M4 18h16",strokeLinecap:"round",strokeLinejoin:"round"})})}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("h1",{className:`text-xl font-semibold ${n?"text-gray-100":"text-gray-900"}`,children:"ComparePhotos"}),s.jsx("button",{onClick:()=>v(!0),className:`ml-2 w-6 h-6 rounded-full flex items-center justify-center ${n?"bg-gray-800 text-gray-300 hover:bg-gray-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"} transition-colors`,title:"",children:s.jsx("svg",{className:"w-3.5 h-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 110 20 10 10 0 010-20z"})})})]}),s.jsxs("div",{className:`px-4 py-1.5 rounded-full backdrop-blur-md transition-all duration-200 ${n?"bg-gray-900 text-white":"bg-sky-500/10 text-gray-900"} flex items-center desktop-only`,children:[s.jsx("span",{className:"text-sm font-medium mr-3",children:n?"":""}),s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"checkbox",checked:n,onChange:e,className:"sr-only peer"}),s.jsx("div",{className:`relative w-14 h-7 rounded-full transition-all duration-200 
                  ${n?"bg-sky-500":"bg-gray-300"} 
                  cursor-pointer
                  after:content-[''] after:absolute after:top-1 after:left-1 
                  after:bg-white after:rounded-full after:h-5 after:w-5 
                  after:shadow-md after:transition-all
                  ${n?"after:translate-x-7":"after:translate-x-0"}
                  peer-focus:ring-2 peer-focus:ring-sky-400 peer-focus:ring-opacity-50`,children:s.jsx("span",{className:"sr-only",children:""})})]})]}),a.length>0&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`px-4 py-1.5 rounded-full backdrop-blur-md transition-all duration-200 ${n?"bg-gray-900 text-white":"bg-sky-500/10 text-gray-900"} flex items-center desktop-only`,children:[s.jsx("span",{className:"text-sm font-medium mr-3",children:""}),s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"checkbox",checked:i,onChange:o,className:"sr-only peer"}),s.jsx("div",{className:`relative w-14 h-7 rounded-full transition-all duration-200 
                      ${i?"bg-sky-500":n?"bg-gray-800":"bg-gray-300"} 
                      cursor-pointer
                      after:content-[''] after:absolute after:top-1 after:left-1 
                      after:bg-white after:rounded-full after:h-5 after:w-5 
                      after:shadow-md after:transition-all
                      ${i?"after:translate-x-7":"after:translate-x-0"}
                      peer-focus:ring-2 peer-focus:ring-sky-400 peer-focus:ring-opacity-50`,children:s.jsx("span",{className:"sr-only",children:""})})]})]}),s.jsxs("div",{className:`px-4 py-1.5 rounded-full backdrop-blur-md transition-all duration-200 ml-2 ${E?"bg-sky-600 text-white":n?"bg-gray-900 text-white":"bg-sky-500/10 text-gray-900"} flex items-center desktop-only`,children:[s.jsx("span",{className:"text-sm font-medium mr-3",children:""}),s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"checkbox",checked:E,onChange:ee=>P(ee.target.checked),className:"sr-only peer"}),s.jsx("div",{className:`relative w-14 h-7 rounded-full transition-all duration-200 
                      ${E?"bg-sky-500":n?"bg-gray-800":"bg-gray-300"} 
                      cursor-pointer
                      after:content-[''] after:absolute after:top-1 after:left-1 
                      after:bg-white after:rounded-full after:h-5 after:w-5 
                      after:shadow-md after:transition-all
                      ${E?"after:translate-x-7":"after:translate-x-0"}
                      peer-focus:ring-2 peer-focus:ring-sky-400 peer-focus:ring-opacity-50`,children:s.jsx("span",{className:"sr-only",children:""})})]})]}),s.jsxs("div",{className:`px-4 py-1.5 rounded-full backdrop-blur-md transition-all duration-200 ml-2 ${w?"bg-sky-600 text-white":n?"bg-gray-900 text-white":"bg-sky-500/10 text-gray-900"} flex items-center desktop-only`,children:[s.jsx("span",{className:"text-sm font-medium mr-3",children:""}),s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"checkbox",checked:w,onChange:ee=>u(ee.target.checked),className:"sr-only peer"}),s.jsx("div",{className:`relative w-14 h-7 rounded-full transition-all duration-200 
                      ${w?"bg-sky-500":n?"bg-gray-800":"bg-gray-300"} 
                      cursor-pointer
                      after:content-[''] after:absolute after:top-1 after:left-1 
                      after:bg-white after:rounded-full after:h-5 after:w-5 
                      after:shadow-md after:transition-all
                      ${w?"after:translate-x-7":"after:translate-x-0"}
                      peer-focus:ring-2 peer-focus:ring-sky-400 peer-focus:ring-opacity-50`,children:s.jsx("span",{className:"sr-only",children:""})})]})]})]})]}),s.jsx(Cs,{})]}),s.jsxs("main",{className:"h-full pt-16",children:[a.length===0&&!ht.getState().hasViewedImages?s.jsx(bs,{}):s.jsx(vs,{images:a}),s.jsx(Zs,{})]}),s.jsx("footer",{className:"fixed bottom-0 left-0 right-0 p-6 backdrop-blur-md bg-white/5 dark:bg-black app-footer",children:s.jsxs("div",{className:`max-w-screen-xl mx-auto flex items-center justify-between ${n?"text-white/60":"text-gray-600"}`,children:[s.jsxs("div",{className:"flex items-center space-x-2 group",children:[s.jsx("span",{className:"text-sm transition-all duration-300 group-hover:text-sky-500",children:"Created by Jim"}),s.jsx("span",{className:"text-sm opacity-60",children:""}),s.jsxs("a",{href:"https://space.bilibili.com/13818699",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1.5 text-sm transition-all duration-300 hover:text-sky-500",children:[s.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M17.813 4.653h.854c1.51.054 2.769.578 3.773 1.574 1.004.995 1.524 2.249 1.56 3.76v7.36c-.036 1.51-.556 2.769-1.56 3.773s-2.262 1.524-3.773 1.56H5.333c-1.51-.036-2.769-.556-3.773-1.56S.036 18.858 0 17.347v-7.36c.036-1.511.556-2.765 1.56-3.76 1.004-.996 2.262-1.52 3.773-1.574h.774l-1.174-1.12a1.234 1.234 0 0 1-.373-.906c0-.356.124-.658.373-.907l.027-.027c.267-.249.573-.373.92-.373.347 0 .653.124.92.373L9.653 4.44c.071.071.134.142.187.213h4.267a.836.836 0 0 1 .16-.213l2.853-2.747c.267-.249.573-.373.92-.373.347 0 .662.151.929.4.267.249.391.551.391.907 0 .355-.124.657-.373.906L17.813 4.653zM5.333 7.24c-.746.018-1.373.276-1.88.773-.506.498-.769 1.13-.786 1.894v7.52c.017.764.28 1.395.786 1.893.507.498 1.134.756 1.88.773h13.334c.746-.017 1.373-.275 1.88-.773.506-.498.769-1.129.786-1.893v-7.52c-.017-.765-.28-1.396-.786-1.894-.507-.497-1.134-.755-1.88-.773H5.333zM8 11.107c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c0-.373.129-.689.386-.947.258-.257.574-.386.947-.386zm8 0c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c0-.373.129-.689.386-.947.258-.257.574-.386.947-.386zm8 0c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c.017-.391.15-.711.4-.96.249-.249.56-.373.933-.373Z"})}),s.jsx("span",{children:"@Jim"})]}),s.jsx("span",{className:"text-sm opacity-60",children:""}),s.jsxs("span",{className:"text-sm opacity-60",children:[" ",new Date().getFullYear()]}),s.jsx("span",{className:"text-sm opacity-60",children:""}),s.jsx("span",{className:"text-sm opacity-60",children:"v1.1.9"}),s.jsx("span",{className:"text-sm opacity-60",children:""}),s.jsx("button",{className:"text-sm text-sky-500 hover:underline focus:outline-none focus:underline ml-2",onClick:()=>h(!0),style:{background:"none",border:"none",padding:0,cursor:"pointer"},children:""})]}),s.jsx("div",{className:"text-sm opacity-60",children:"Made with  in China"})]})}),g&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",onClick:()=>h(!1),children:s.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-2xl p-8 flex flex-col items-center relative",onClick:ee=>ee.stopPropagation(),children:[s.jsx("span",{className:"absolute top-2 right-3 text-2xl text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 cursor-pointer",onClick:()=>h(!1),children:""}),s.jsx("div",{className:"w-48 h-48 mb-4 flex items-center justify-center bg-gray-100 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:s.jsx("img",{src:"/comparePhotos/placeholder-qrcode.jpeg",alt:"",className:"max-w-full max-h-full object-contain"})}),s.jsx("div",{className:"text-base font-medium text-gray-700 dark:text-gray-200",children:""})]})}),x&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",onClick:()=>v(!1),children:s.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-2xl p-8 max-w-md w-full flex flex-col relative",onClick:ee=>ee.stopPropagation(),children:[s.jsx("span",{className:"absolute top-2 right-3 text-2xl text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 cursor-pointer",onClick:()=>v(!1),children:""}),s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100 mb-4",children:" ComparePhotos"}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-md font-semibold text-gray-700 dark:text-gray-300 mb-2",children:""}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:": v1.1.9"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-md font-semibold text-gray-700 dark:text-gray-300 mb-2",children:""}),s.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1 list-disc pl-5",children:[s.jsx("li",{children:"/"}),s.jsx("li",{children:"UI"}),s.jsx("li",{children:"0.513"}),s.jsx("li",{children:""}),s.jsx("li",{children:"UI"})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-md font-semibold text-gray-700 dark:text-gray-300 mb-2",children:""}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("a",{href:"https://github.com/jimmcheung/photoCompare",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 text-sm text-sky-600 dark:text-sky-400 hover:underline",children:[s.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"})}),s.jsx("span",{children:"GitHub "})]}),s.jsxs("a",{href:"https://space.bilibili.com/13818699",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 text-sm text-sky-600 dark:text-sky-400 hover:underline",children:[s.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M17.813 4.653h.854c1.51.054 2.769.578 3.773 1.574 1.004.995 1.524 2.249 1.56 3.76v7.36c-.036 1.51-.556 2.769-1.56 3.773s-2.262 1.524-3.773 1.56H5.333c-1.51-.036-2.769-.556-3.773-1.56S.036 18.858 0 17.347v-7.36c.036-1.511.556-2.765 1.56-3.76 1.004-.996 2.262-1.52 3.773-1.574h.774l-1.174-1.12a1.234 1.234 0 0 1-.373-.906c0-.356.124-.658.373-.907l.027-.027c.267-.249.573-.373.92-.373.347 0 .653.124.92.373L9.653 4.44c.071.071.134.142.187.213h4.267a.836.836 0 0 1 .16-.213l2.853-2.747c.267-.249.573-.373.92-.373.347 0 .662.151.929.4.267.249.391.551.391.907 0 .355-.124.657-.373.906L17.813 4.653zM5.333 7.24c-.746.018-1.373.276-1.88.773-.506.498-.769 1.13-.786 1.894v7.52c.017.764.28 1.395.786 1.893.507.498 1.134.756 1.88.773h13.334c.746-.017 1.373-.275 1.88-.773.506-.498.769-1.129.786-1.893v-7.52c-.017-.765-.28-1.396-.786-1.894-.507-.497-1.134-.755-1.88-.773H5.333zM8 11.107c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c0-.373.129-.689.386-.947.258-.257.574-.386.947-.386zm8 0c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c0-.373.129-.689.386-.947.258-.257.574-.386.947-.386zm8 0c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c.017-.391.15-.711.4-.96.249-.249.56-.373.933-.373Z"})}),s.jsx("span",{children:"B: @Jim"})]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-md font-semibold text-gray-700 dark:text-gray-300 mb-2",children:""}),s.jsxs("a",{href:"https://space.bilibili.com/96625571",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 text-sm text-sky-600 dark:text-sky-400 hover:underline",children:[s.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M17.813 4.653h.854c1.51.054 2.769.578 3.773 1.574 1.004.995 1.524 2.249 1.56 3.76v7.36c-.036 1.51-.556 2.769-1.56 3.773s-2.262 1.524-3.773 1.56H5.333c-1.51-.036-2.769-.556-3.773-1.56S.036 18.858 0 17.347v-7.36c.036-1.511.556-2.765 1.56-3.76 1.004-.996 2.262-1.52 3.773-1.574h.774l-1.174-1.12a1.234 1.234 0 0 1-.373-.906c0-.356.124-.658.373-.907l.027-.027c.267-.249.573-.373.92-.373.347 0 .653.124.92.373L9.653 4.44c.071.071.134.142.187.213h4.267a.836.836 0 0 1 .16-.213l2.853-2.747c.267-.249.573-.373.92-.373.347 0 .662.151.929.4.267.249.391.551.391.907 0 .355-.124.657-.373.906L17.813 4.653zM5.333 7.24c-.746.018-1.373.276-1.88.773-.506.498-.769 1.13-.786 1.894v7.52c.017.764.28 1.395.786 1.893.507.498 1.134.756 1.88.773h13.334c.746-.017 1.373-.275 1.88-.773.506-.498.769-1.129.786-1.893v-7.52c-.017-.765-.28-1.396-.786-1.894-.507-.497-1.134-.755-1.88-.773H5.333zM8 11.107c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c0-.373.129-.689.386-.947.258-.257.574-.386.947-.386zm8 0c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c0-.373.129-.689.386-.947.258-.257.574-.386.947-.386zm8 0c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c.017-.391.15-.711.4-.96.249-.249.56-.373.933-.373Z"})}),s.jsx("span",{children:"B@Bearie"})]})]}),s.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:[" ",new Date().getFullYear()," Jim. "]})]})}),l&&s.jsx("div",{className:"fixed inset-0 flex items-center justify-center pointer-events-none",children:s.jsx("div",{className:"bg-black bg-opacity-75 text-white px-6 py-3 rounded-lg",children:" ESC "})}),s.jsx(to,{isOpen:F,onClose:()=>k(!1),darkMode:n,toggleDarkMode:e,syncZoom:i,toggleSyncZoom:o,images:a}),se&&s.jsx(eo,{})]})})};on.createRoot(document.getElementById("root")).render(s.jsx(ne.StrictMode,{children:s.jsx(no,{})}));
